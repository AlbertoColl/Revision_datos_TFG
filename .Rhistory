pca_per <- PCAtest(datos_pca_t)
warnings()
datos <- read.csv2("./datos/TFG_datos_2025.csv", numerals = "warn.loss", encoding = "latin1")%>%
mutate(playa = as.factor(playa), cultivo = as.factor(cultivo),
section = as.factor(corte), time = as.factor(madurez)) %>%
select(-madurez, -corte) %>% relocate(section, .after = cultivo)
View(datos)
datos_long2 <- read.csv2("./datos/Datos_sin_NaS_2025.csv", numerals = "warn.loss", encoding = "latin1")%>%
mutate(playa = as.factor(playa), cultivo = as.factor(cultivo),
section = as.factor(corte), time = as.factor(madurez)) %>%
select(-madurez, -corte) %>% relocate(section, .after = cultivo)
datos_long2 <- read.csv2("./datos/Datos_sin_NaS_2025.csv", numerals = "warn.loss", encoding = "latin1")%>%
mutate(playa = as.factor(playa), cultivo = as.factor(cultivo),
section = as.factor(corte), time = as.factor(madurez), group = section:time) %>%
select(-madurez, -corte) %>% relocate(section, .after = cultivo)
ggboxplot(datos_long2, x = "group", y = "SOD")
ggboxplot(datos_long2, x = "group", y = "SOD", color = "group")
ggboxplot(datos_long2, x = "group", y = "SOD", color = "time")
ggboxplot(datos_long2, x = "group", y = "SOD", color = "section")
?ggboxplot
ggboxplot(datos_long2, x = "group", y = "SOD", color = "section", add = "dotplot")
ggboxplot(datos_long2, x = "group", y = "SOD", color = "section", add = "jitter")
ggboxplot(filter(datos_long2, tejido == "Tentaculo"), x = "group", y = "SOD", color = "section", add = "jitter")
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "SOD", color = "section", add = "jitter")
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "SOD", color = "section", add = "jitter")
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "CAT", color = "section", add = "jitter")
datos_long2$CAT[41]
datos_long2$CAT[41] <- NA
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "CAT", color = "section", add = "jitter")
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "GPx", color = "section", add = "jitter")
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "GR", color = "section", add = "jitter")
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "GST", color = "section", add = "jitter")
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "DTD", color = "section", add = "jitter")
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "G6PDH", color = "section", add = "jitter")
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "MDA", color = "section", add = "jitter")
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "TEAC", color = "section", add = "jitter")
datos_long2$MDA[31]
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "TEAC", color = "section", add = "jitter")
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "Facida", color = "section", add = "jitter")
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "Fbasica", color = "section", add = "jitter")
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "Mielo", color = "section", add = "jitter")
# PCA tentacular ----
datos_pca_t <- datos_2 %>% filter(tejido == "Tentaculo") %>%
select(c(6:18), -proteina)
# PCA tentacular ----
datos_pca_t <- datos_long2 %>%  filter(cultivo == "Si", tejido == "Tentaculo") %>%
select(c(6:18), -proteina)
colnames(datos_pca_t) <- c("SOD", "CAT", "GPx", "GR", "GST", "DTD", "G6PDH", "TEAC", "MDA", "Acid.phospatase", "Alkaline.phosphatase", "MPx")
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_t)
# Test complementarios
KMO(datos_pca_t) # Overall MSA =  0.5
cortest.bartlett(datos_pca_t, nrow(datos_pca_t)) # p value =  8.707474e-11
mvn(datos_pca_t, mvn = "mardia") # Hay normalidad multivariable. Los componentes principales son independientes
pc_tent <- princomp(~., data = as.data.frame(datos_pca_t), cor = TRUE)
summary(pc_tent)
fviz_pca_biplot(pc_tent)
summary(pc_tent)
(biplot_t <- fviz_pca_biplot(pc_tent, col.ind = na.omit(select(filter(datos_2, tejido == "Tentaculo"), -Lisozima))$section:na.omit(select(filter(datos_2, tejido == "Tentaculo"), -Lisozima))$time,
pointshape = 16, pointsize = 4.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
#scale_color_manual(labels = c("Arbacia lixula", "Paracentrotus lividus", "Sphaerechinus granularis"), values = c("#E64B35FF", "#4DBBD5FF", "#00A087FF")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(biplot_t <- fviz_pca_biplot(pc_tent, col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$time,
pointshape = 16, pointsize = 4.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
biplot
(biplot <- fviz_pca_biplot(pc_full, col.ind = na.omit(select(datos_2, -Lisozima))$section:na.omit(select(datos_2, -Lisozima))$time,
pointshape = 16, pointsize = 4.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
biplot_t
(biplot <- fviz_pca_biplot(pc_full, col.ind = na.omit(select(datos_2, -Lisozima))$section:na.omit(select(datos_2, -Lisozima))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(biplot_t <- fviz_pca_biplot(pc_tent, col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
# Test complementarios
KMO(datos_pca_t) # Overall MSA =  0.59
# PCA tentacular ----
datos_pca_t <- datos_long2 %>%  filter(cultivo == "Si", tejido == "Tentaculo") %>%
select(c(6:18), -proteina, -G6PDH, -TEAC, -MDA)
colnames(datos_pca_t) <- c("SOD", "CAT", "GPx", "GR", "GST", "DTD", "Acid.phospatase", "Alkaline.phosphatase", "MPx")
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_t)
# Test complementarios
KMO(datos_pca_t) # Overall MSA =  0.59
mvn(datos_pca_t, mvn = "mardia") # Hay normalidad multivariable. Los componentes principales son independientes
pc_tent <- princomp(~., data = as.data.frame(datos_pca_t), cor = TRUE)
summary(pc_tent)
(biplot_t <- fviz_pca_biplot(pc_tent, col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
pc_tent <- princomp(~., data = as.data.frame(datos_pca_t), cor = TRUE)
summary(pc_tent)
(biplot_t <- fviz_pca_biplot(pc_tent, col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -MDA, -TEAC, -G6PDH))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"),-Lisozima, -MDA, -TEAC, -G6PDH))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_t)
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_t)
View(datos_long2)
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "TEAC", color = "section", add = "jitter")
datos_long2$TEAC[17]
datos_long2$TEAC[39]
datos_long2$TEAC[39] <- NA
datos_long2$CAT[41] <- NA
datos_long2$MDA[31] <- NA
datos_long2$TEAC[17] <- NA
datos_long2$TEAC[39] <- NA
# PCA tentacular ----
datos_pca_t <- datos_long2 %>%  filter(cultivo == "Si", tejido == "Tentaculo") %>%
select(c(6:18), -proteina)
colnames(datos_pca_t) <- c("SOD", "CAT", "GPx", "GR", "GST", "DTD", "G6PDH", "TEAC", "MDA", "Acid.phospatase", "Alkaline.phosphatase", "MPx")
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_t)
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_t)
library(rstatix)
?mahalanobis_distance()
datos_long2 %>%
group_by(tejido) %>%
doo(~mahalanobis_distance(.))
datos_long2 %>%
group_by(tejido) %>%
doo(~mahalanobis_distance(.)) %>%
filter(is.outlier == TRUE)
datos_long2 %>%
group_by(tejido) %>%
doo(~mahalanobis_distance(.))
view(datos_long2 %>%
group_by(tejido) %>%
doo(~mahalanobis_distance(.)) )
view(datos_long2 %>%
filter(tejido == "Tentaculo") %>%
doo(~mahalanobis_distance(.)) )
view(datos_long2 %>%
doo(~mahalanobis_distance(.)) )
view(datos_pca_full %>%
doo(~mahalanobis_distance(.)) )
datos_pca_t %>%
doo(~mahalanobis_distance(.))
view(datos_pca_t %>%
doo(~mahalanobis_distance(.)))
view(datos_pca_t %>% na.omit() %>%
doo(~mahalanobis_distance(.)))
view(datos_pca %>% na.omit() %>%
doo(~mahalanobis_distance(.)))
view(datos_pca_full %>% na.omit() %>%
doo(~mahalanobis_distance(.)))
view(datos_pca_p %>% na.omit() %>%
doo(~mahalanobis_distance(.)))
# PCA tentacular ----
datos_pca_t <- datos_long2 %>%  filter(cultivo == "Si", tejido == "Tentaculo") %>%
select(c(6:18), -proteina)
colnames(datos_pca_t) <- c("SOD", "CAT", "GPx", "GR", "GST", "DTD", "G6PDH", "TEAC", "MDA", "Acid.phospatase", "Alkaline.phosphatase", "MPx")
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_t)
datos_long2 <- read.csv2("./datos/Datos_sin_NaS_2025.csv", numerals = "warn.loss", encoding = "latin1")%>%
mutate(playa = as.factor(playa), cultivo = as.factor(cultivo),
section = as.factor(corte), time = as.factor(madurez), group = section:time) %>%
select(-madurez, -corte) %>% relocate(section, .after = cultivo)
datos$playa <- factor(datos$playa, levels = c("Calahonda", "Almu単ecar", "Salobre単a")) # Reordenar niveles
datos_long$playa <- factor(datos$playa, levels = c("Calahonda", "Almu単ecar", "Salobre単a")) # Reordenar niveles
# Poner in english los nombres de los niveles
datos$section <- factor(datos$section, levels = c("No", "Si"), labels = c("control", "dissected"))
datos$cultivo <- factor(datos$cultivo, levels = c("No", "Si"), labels = c("wild", "cultured"))
datos$time <- factor(datos$time, levels = c("No", "Si"), labels = c("0", "1"))
# Limpieza de datos ----
datos <- datos %>%
mutate(GPx_t = ifelse(GPx_t < 0, NA, GPx_t),
GPx_p = ifelse(GPx_p < 0, NA, GPx_p))  # hay datos de gpx negativos
ggboxplot(filter(datos_long2, tejido == "Tentaculo", cultivo == "Si"), x = "group", y = "TEAC", color = "section", add = "jitter")
datos_long2$CAT[41] <- NA
datos_long2$MDA[31] <- NA
# PCA tentacular ----
datos_pca_t <- datos_long2 %>%  filter(cultivo == "Si", tejido == "Tentaculo") %>%
select(c(6:18), -proteina)
colnames(datos_pca_t) <- c("SOD", "CAT", "GPx", "GR", "GST", "DTD", "G6PDH", "TEAC", "MDA", "Acid.phospatase", "Alkaline.phosphatase", "MPx")
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_t)
# Test complementarios
KMO(datos_pca_t) # Overall MSA =  0.59
cortest.bartlett(datos_pca_t, nrow(datos_pca_t)) # p value =  4.045311e-11
mvn(datos_pca_t, mvn = "mardia") # Hay normalidad multivariable. Los componentes principales son independientes
pc_tent <- princomp(~., data = as.data.frame(datos_pca_t), cor = TRUE)
summary(pc_tent)
(biplot_t <- fviz_pca_biplot(pc_tent, col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
?fviz_pca_biplot()
(biplot_t <- fviz_pca_biplot(pc_tent, axes = c(1,3), col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(biplot_t <- fviz_pca_biplot(pc_tent, axes = c(1,2), col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(biplot_t <- fviz_pca_biplot(pc_tent, axes = c(2,3), col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(biplot <- fviz_pca_biplot(pc_full, axes = c(2,3), col.ind = na.omit(select(datos_2, -Lisozima))$section:na.omit(select(datos_2, -Lisozima))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(biplot <- fviz_pca_biplot(pc_full, axes = c(1,3), col.ind = na.omit(select(datos_2, -Lisozima))$section:na.omit(select(datos_2, -Lisozima))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(biplot <- fviz_pca_biplot(pc_full, axes = c(1,2), col.ind = na.omit(select(datos_2, -Lisozima))$section:na.omit(select(datos_2, -Lisozima))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
# PCA conjunto ----
datos_pca_full <- datos_2 %>%
select(c(6:18), -proteina)
colnames(datos_pca_full) <- c("SOD", "CAT", "GPx", "GR", "GST", "DTD", "G6PDH", "TEAC", "MDA", "Acid.phospatase", "Alkaline.phosphatase", "MPx")
pca_per <- PCAtest(datos_pca_full)
View(datos_pca_full)
View(datos_2)
View(datos)
View(datos_2)
# PCA columnar ----
datos_pca_p <- datos_2 %>% filter(tejido == "Pie") %>%
select(c(6:18), -proteina)
colnames(datos_pca_p) <- c("SOD", "CAT", "GPx", "GR", "GST", "DTD", "G6PDH", "TEAC", "MDA", "Acid.phospatase", "Alkaline.phosphatase", "MPx")
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_p)
pc_pie <- princomp(~., data = as.data.frame(datos_pca_p), cor = TRUE)
summary(pc_pie)
(biplot_p <- fviz_pca_biplot(pc_pie, col.ind = na.omit(select(filter(datos_2, tejido == "Pie"), -Lisozima))$section:na.omit(select(filter(datos_2, tejido == "Pie"), -Lisozima))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#D6604D", "#F4A582")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
View(pca_per)
(biplot_p <- fviz_pca_biplot(pc_pie, col.ind = na.omit(select(filter(datos_2, tejido == "Pie"), -Lisozima))$section:na.omit(select(filter(datos_2, tejido == "Pie"), -Lisozima))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
# PCA tentacular ----
datos_pca_t <- datos_long2 %>%  filter(cultivo == "Si", tejido == "Tentaculo") %>%
select(c(6:18), -proteina)
colnames(datos_pca_t) <- c("SOD", "CAT", "GPx", "GR", "GST", "DTD", "G6PDH", "TEAC", "MDA", "Acid.phospatase", "Alkaline.phosphatase", "MPx")
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_t)
pc_tent <- princomp(~., data = as.data.frame(datos_pca_t), cor = TRUE)
summary(pc_tent)
(biplot_t <- fviz_pca_biplot(pc_tent, axes = c(1,2), col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
colnames(datos_pca_p) <- c("SOD", "CAT", "GPx", "GR", "GST", "DTD", "TEAC", "MDA", "Acid.phospatase", "Alkaline.phosphatase", "MPx")
# PCA columnar ----
datos_pca_p <- datos_2 %>% filter(tejido == "Pie") %>%
select(c(6:18), -proteina, -G6PDH)
colnames(datos_pca_p) <- c("SOD", "CAT", "GPx", "GR", "GST", "DTD", "TEAC", "MDA", "Acid.phospatase", "Alkaline.phosphatase", "MPx")
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_p)
View(datos_pca_p)
# Test complementarios
KMO(datos_pca_p) # Overall MSA =  0.5
cortest.bartlett(datos_pca_p, nrow(datos_pca_p)) # p value =  8.707474e-11
mvn(datos_pca_p, mvn = "mardia") # Hay normalidad multivariable. Los componentes principales son independientes
pc_pie <- princomp(~., data = as.data.frame(datos_pca_p), cor = TRUE)
summary(pc_pie)
(biplot_p <- fviz_pca_biplot(pc_pie, col.ind = na.omit(select(filter(datos_2, tejido == "Pie"), -Lisozima))$section:na.omit(select(filter(datos_2, tejido == "Pie"), -Lisozima))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(biplot_p <- fviz_pca_biplot(pc_pie, col.ind = na.omit(select(filter(datos_2, tejido == "Pie"), -Lisozima, -G6PDH))$section:na.omit(select(filter(datos_2, tejido == "Pie"), -Lisozima, -G6PDH))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
# PCA tentacular ----
datos_pca_t <- datos_long2 %>%  filter(cultivo == "Si", tejido == "Tentaculo") %>%
select(c(6:18), -proteina, -G6PDH)
colnames(datos_pca_t) <- c("SOD", "CAT", "GPx", "GR", "GST", "DTD", "TEAC", "MDA", "Acid.phospatase", "Alkaline.phosphatase", "MPx")
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_t)
View(datos_pca_t)
# Test complementarios
KMO(datos_pca_t) # Overall MSA =  0.6
cortest.bartlett(datos_pca_t, nrow(datos_pca_t)) # p value =  2.998402e-11
mvn(datos_pca_t, mvn = "mardia") # Hay normalidad multivariable. Los componentes principales son independientes
pc_tent <- princomp(~., data = as.data.frame(datos_pca_t), cor = TRUE)
summary(pc_tent)
(biplot_t <- fviz_pca_biplot(pc_tent, axes = c(1,2), col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(biplot_t <- fviz_pca_biplot(pc_tent, axes = c(1,2), col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
