### SETUP ----
#setwd("C:/Users/Usuario/Documents/GitHub/Revision_datos_TFG")
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
#source(file = "./scripts septiembre 2024-2025/0_data_lab.R")
source(file = "./scripts septiembre 2024-2025/0_data_laptop.R")
### SETUP ----
#setwd("C:/Users/Usuario/Documents/GitHub/Revision_datos_TFG")
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
source(file = "./scripts septiembre 2024-2025/0_lectura.R")
source(file = "./scripts septiembre 2024-2025/0_lectura.R")
data <- filter(datos_long, cultivo == "Si") %>%
mutate(grupo = time:section)
data$GPx[9] <- NA # Afecta a homcedasticidad y es extremo
data$GPx[6] <- NA #HOMOCEDASTICIDAD
data$GPx[2] <- NA
data$GPx[33] <- NA #posible
data$GPx[4] <- NA # Quitar el otro dato  #4 para l GPx tentacular
data$GPx[38] <- NA # outlier extremo
data$GPx[51] <- NA # extremo
data$GPx[53] <- NA
data$GPx[66] <- NA
data$GPx[69] <- NA
# Se eliminan:
data$SOD[7] <- NA #para normalidad
data$SOD[3] <- NA #para normalidad
data$CAT[35] <- NA # La funcion ha identificado otro, pero su eliminacion no afecta a la normalidad de residuos, este si.
data$Mielo[62] <- NA
data$Mielo[18] <- NA #Sospechoso, y afecta a normalidad
data$Facida[66] # sospechoso, outlier no extremo
data$Fbasica[48] <- NA # outlier extremo
data$Fbasica[51] # incrementa mucho error pero no se puede quitar porque violaria homocedasticidad
data$Fbasica[9] <- NA # Afecta a homocedasticidad
data$Lisozima[69] <- NA # outlier extremo
data$Lisozima[70] <- NA # outlier extremo
data$Lisozima[38] <- NA # outlier extremo
data$MDA[65] <- NA # Outlier no extremo pero parece que puede afectar al resultado del analisis y afecta a la varianza del grupo.
ggboxplot(data, x = "time", y = "CAT", color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
library(ggpubr)
ggboxplot(data, x = "time", y = "CAT", color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
# Paleta (unificar con PCA)
c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")
colnames(data)
colnames(data[6:20])
colnames(data[6:19])
?sapply
f.boxplot <- function(x){
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
}
plots <- sapply(colnames(data[6:19]), f.boxplot)
plots[1]
plots[2]
ggbarplot(data, x = "time", y = "CAT", color = "grupo", fill = "grupo")
ggbarplot(data, x = "time", y = "CAT", color = "grupo", fill = "grupo", position = "dodge2")
ggbarplot(data, x = "time", y = "CAT", color = "grupo", fill = "grupo", position = position_dodge2())
?ggbarplot
ggbarplot(data, x = "time", y = "CAT", color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("mean"), facet.by = "tejido", error.plot = "errorbar", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
ggbarplot(data, x = "grupo", y = "CAT", color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("mean"), facet.by = "tejido", error.plot = "errorbar", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
n <- 1
sprintf("%s.png", n)
ggsave?
?ggsve()
?ggsave()
sapply(plots, ggsave(filename = sprintf("%s.png", x), plot = x, path = "./resultados/graficas2025/boxplot"))
?sapply()
sapply(plots, function(x){
ggsave(filename = sprintf("%s.png", x), plot = x, path = "./resultados/graficas2025/boxplot"))
ggsave(filename = sprintf("%s.png", x), plot = x, path = "./resultados/graficas2025/boxplot")
f.boxplot <- function(x){
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
filename = sprintf("%s.png", x)
ggsave(filename, path = "./resultados/graficas2025/boxplot")
}
plots <- sapply(colnames(data[6:19]), f.boxplot)
warnings()
plots <- sapply(colnames(data[6:18]), f.boxplot)
x <- "CAT"
get(x)
data$get(x)
data$x
select(data, x)
data %>% select(all_of(x))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, max(select(data, all_of(x))))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.5*max(select(data, all_of(x))))
max(select(data, all_of(x)))
select(data, all_of(x))
max(select(data, all_of(x)))
max(data %>% select(x))
summary(data)
select(data, all_of(x))
typeof(select(data, all_of(x)))
typeof(as.vector(select(data, all_of(x))))
?max()
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.5*max(x)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.5*max(get(x))) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
get("data$CAT")
View(data)
DATA
data
typeof(data$CAT)
as.double(select(data, all_of(x)))
as_vector(select(data, all_of(x)))
max(as_vector(select(data, all_of(x))))
max(unlist(select(data, all_of(x))))
unlist(select(data, all_of(x)))
select(data, all_of(x))
match(x, colnames(data))
x
data[7]
max(data[7])
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.5*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.4*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.25*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
# Funcion de grafica y guardado
f.boxplot <- function(x){
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
filename = sprintf("%s.png", x)
ggsave(filename, path = "./resultados/graficas2025/boxplot")
}
plots <- sapply(colnames(data[6:18]), f.boxplot)
warnings()
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1, size = 0.7), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(c(shape = 1, size = .5)), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(c(shape = 1, size = .5), size = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1, size = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1, shape = 18), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9)) +
annotate("text", label = c("Section - ", "Time - ", "Section*Time - "), x = 2.35, y = layer_scales(p)$y$get_limits()[2]*c(1,.95,.9), hjust = 0, size = 9 /.pt)
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9)) +
annotate("text", label = c("Section - ", "Time - ", "Section*Time - "), x = 2.35, y = 1.2*max(data %>% select(x), na.rm = T)*c(1,.95,.9), hjust = 0, size = 9 /.pt)
rlang::last_trace()
?annotate()
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9)) +
annotate("text", label = c("Section", "Time", "Section*Time"), x = 2.35, y = 1.2*max(data %>% select(x), na.rm = T)*c(1,.95,.9), hjust = 0, size = 9 /.pt)
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9)) +
annotate("text", label = c("Section", "Time", "Section*Time"), x = 2.35, y = 1.2*max(data %>% select(x), na.rm = T), hjust = 0, size = 9 /.pt)
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9)) +
annotate("text", label = rep(c("Section", "Time", "Section*Time"), 2), x = 2.35, y = 1.2*max(data %>% select(x), na.rm = T)*c(1,.95,.9), hjust = 0, size = 9 /.pt)
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9)) +
annotate("text", label = rep(c("Section", "Time", "Section*Time"), 2), x = 2.35, y = 1.2*max(data %>% select(x), na.rm = T)*rep(c(1,.95,.9),2), hjust = 0, size = 9 /.pt)
rep(c("Section", "Time", "Section*Time"), 2)
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9)) +
annotate("text", label = rep(c("Section", "Time", "Section*Time"), 2), x = rep(2.35, 6), y = rep(1.2*max(data %>% select(x), na.rm = T), 6), hjust = 0, size = 9 /.pt)
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9)) +
annotate("text", label = c("Section", "Time", "Section*Time"), x = rep(2.35, 6), y = rep(1.2*max(data %>% select(x), na.rm = T), 6), hjust = 0, size = 9 /.pt)
, 2)
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9)) +
annotate("text", label = rep(c("Section", "Time", "Section*Time"), 2), x = rep(2.35, 6), y = rep(1.2*max(data %>% select(x), na.rm = T), 6), hjust = 0, size = 9 /.pt)
data.frame(variable = "CAT", tejido = c("Pie", "Tentaculo"), label = c(c("Section", "Time", "Section*Time"), c("Section", "Time", "Section*Time")))
data.frame(variable = "CAT", tejido = c("Pie", "Tentaculo"), label = c("Section", "Time", "Section*Time"))
data.frame(variable = "CAT", tejido = c("Pie", "Tentaculo"), label = rep(c("Section\nTime\nSection*Time"),2)
data.frame(variable = "CAT", tejido = c("Pie", "Tentaculo"), label = rep(c("Section\nTime\nSection*Time"),2))
labels <- data.frame(variable = "CAT", tejido = c("Pie", "Tentaculo"), label = rep(c("Section\nTime\nSection*Time"),2))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
geom_text(labels, aes(x = 2.35, y =1.2*max(data %>% select(x), na.rm = T), label = label))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
geom_text(data =labels, mapping = aes(x = 2.35, y =1.2*max(data %>% select(x), na.rm = T), label = label))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
geom_text(data =labels, mapping = aes(x = 2.35, y =1*max(data %>% select(x), na.rm = T), label = label))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
geom_text(data =labels, mapping = aes(x = 2.35, y =0.8*max(data %>% select(x), na.rm = T), label = label))
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
geom_text(data =labels, mapping = aes(x = 2, y =0.8*max(data %>% select(x), na.rm = T), label = label))
# Funcion de grafica
f.boxplot <- function(x){
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
filename = sprintf("%s.png", x)
ggsave(filename, path = "./resultados/graficas2025/boxplot")
}
labels <- data.frame(variable = "CAT", tejido = c("Pie", "Tentaculo"), label = rep(c("Section\nTime\nSection*Time"),2))
plots <- sapply(colnames(data[6:18]), f.boxplot)
# Funcion de grafica
f.boxplot <- function(x){
ggboxplot(data, x = "time", y = x, color = "grupo", fill = "grupo", alpha = 0.15, width = 0.5, add = c("jitter", "mean"), add.params = list(shape = 1), facet.by = "tejido", ylab = "U/mg protein", panel.labs = list(tejido = c("Column", "Tentacle"))) +
theme_test() + labs(color = "Treatment")+ labs_pubr() +
scale_x_discrete(labels = c("T1", "T2")) +
scale_fill_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36")) +
scale_color_manual(values = c("#12A3F8","#E64B35FF","#0571B0","#BE2F36"), labels = c("Control T1", "Sectioned T1","Control T2", "Sectioned T2")) + guides(fill = "none") +
ylim(0, 1.2*max(data %>% select(x), na.rm = T)) +
theme(axis.title.x=element_blank(),
axis.text.x = element_text(size = 9))
filename = sprintf("%s.png", x)
filenamesvg = sprintf("%s.svg", x)
ggsave(filename, path = "./resultados/graficas2025/boxplot")
ggsave(filenamesvg, path = "./resultados/graficas2025/boxplot", device = "svg")
}
plots <- sapply(colnames(data[6:18]), f.boxplot)
warnings()
