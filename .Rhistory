cld.tukey <- multcompLetters4(modelos_p[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
(p <- barras_tfm())
ggsave(paste0("./analisis 12-2023/graficas/", i, "_pie.png"), width = 800, height = 1000, units = "px", scale = 2, dpi = "retina")
}
for (n in c(1:10)) { ### TENTACULO
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Tentaculo") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_t[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_t[[n]])
cld.tukey <- multcompLetters4(modelos_t[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
(p <- barras_tfm())
ggsave(paste0("./analisis 12-2023/graficas/", i, "_tent.png"), width = 800, height = 1000, units = "px", scale = 2, dpi = "retina")
}
# Bucle de estadisticos de resumen, test port-hoc y grafica
for (n in c(1:10)) { ### PIE
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Pie") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_p[[n]])
cld.tukey <- multcompLetters4(modelos_p[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
(p <- barras_tfm())
ggsave(paste0("./analisis 12-2023/graficas/2/", i, "_pie.png"), width = 800, height = 1000, units = "px", scale = 2, dpi = "retina")
}
for (n in c(1:10)) { ### TENTACULO
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Tentaculo") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_t[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_t[[n]])
cld.tukey <- multcompLetters4(modelos_t[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
(p <- barras_tfm())
ggsave(paste0("./analisis 12-2023/graficas/2/", i, "_tent.png"), width = 800, height = 1000, units = "px", scale = 2, dpi = "retina")
}
knitr::opts_knit$set(root.dir = "D:/collf/Documents/GitHub/Revision_datos_TFG"
knitr::opts_chunk$set(fig.width=6, fig.height=3, fig.align = "center")
knitr::opts_knit$set(root.dir = "D:/collf/Documents/GitHub/Revision_datos_TFG")
knitr::opts_chunk$set(fig.width=6, fig.height=3, fig.align = "center")
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
library(tidyverse)
library(ggthemr)
library(multcompView)
source(file = "./analisis 12-2023/0_data_home.R")
source(file = "./analisis 12-2023/0_5_graficas.R")
knitr::opts_knit$set(root.dir = "D:/collf/Documents/GitHub/Revision_datos_TFG")
knitr::opts_chunk$set(fig.width=6, fig.height=3, fig.align = "center")
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
library(tidyverse)
library(ggthemr)
library(multcompView)
source(file = "./analisis 12-2023/0_data_home.R")
source(file = "./analisis 12-2023/0_5_graficas.R")
source(file = "./analisis 12-2023/2_analisis corte.R")
# SOD PIE
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 1
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Pie") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_p[[n]])
cld.tukey <- multcompLetters4(modelos_p[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# SOD TENTACULO
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 1
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Tentaculo") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_t[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_t[[n]])
cld.tukey <- multcompLetters4(modelos_t[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# CAT PIE
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 2
# Crear tabla_summ y llamar a barras()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Pie") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_p[[n]])
cld.tukey <- multcompLetters4(modelos_p[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# CAT TENTACULO
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 2
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Tentaculo") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_t[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_t[[n]])
cld.tukey <- multcompLetters4(modelos_t[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# GPX PIE
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 3
# Crear tabla_summ y llamar a barras()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Pie") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_p[[n]])
cld.tukey <- multcompLetters4(modelos_p[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# GPx TENTACULO
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 3
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Tentaculo") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_t[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_t[[n]])
cld.tukey <- multcompLetters4(modelos_t[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# GR TENTACULO
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 4
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Tentaculo") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_t[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_t[[n]])
cld.tukey <- multcompLetters4(modelos_t[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# GR PIE
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 4
# Crear tabla_summ y llamar a barras()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Pie") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_p[[n]])
cld.tukey <- multcompLetters4(modelos_p[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# GST PIE
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 5
# Crear tabla_summ y llamar a barras()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Pie") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_p[[n]])
cld.tukey <- multcompLetters4(modelos_p[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# GST TENTACULO
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 5
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Tentaculo") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_t[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_t[[n]])
cld.tukey <- multcompLetters4(modelos_t[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# DTD PIE
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 6
# Crear tabla_summ y llamar a barras()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Pie") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_p[[n]])
cld.tukey <- multcompLetters4(modelos_p[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# DTD TENTACULO
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 6
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Tentaculo") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_t[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_t[[n]])
cld.tukey <- multcompLetters4(modelos_t[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# G6PDH PIE
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 7
# Crear tabla_summ y llamar a barras()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Pie") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_p[[n]])
cld.tukey <- multcompLetters4(modelos_p[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# G6PDH TENTACULO
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 7
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Tentaculo") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_t[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_t[[n]])
cld.tukey <- multcompLetters4(modelos_t[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# TEAC PIE
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 9
# Crear tabla_summ y llamar a barras()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Pie") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_p[[n]])
cld.tukey <- multcompLetters4(modelos_p[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# TEAC TENTACULO
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 9
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Tentaculo") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_t[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_t[[n]])
cld.tukey <- multcompLetters4(modelos_t[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# MDA PIE
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 10
# Crear tabla_summ y llamar a barras()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Pie") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_p[[n]])
cld.tukey <- multcompLetters4(modelos_p[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
### Evaluacion de modelos y test post hoc ----
for (i in c(1:10)) {
print(colnames(data_2[7:16][i]))
print(summary(modelos_p[[i]]))
}
# MDA TENTACULO
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 10
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Tentaculo") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_t[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_t[[n]])
cld.tukey <- multcompLetters4(modelos_t[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# proteina PIE
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 8
# Crear tabla_summ y llamar a barras()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Pie") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_p[[n]])
cld.tukey <- multcompLetters4(modelos_p[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
# proteina TENTACULO
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
n <- 8
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(data_2[7:16])[[n]]
tabla_summ <- data_2 %>%
filter(tejido == "Tentaculo") %>%   group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_t[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos_t[[n]])
cld.tukey <- multcompLetters4(modelos_t[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "")
}
p <- barras_tfm()
print(p)
