summary(modelos_p1)
summary(modelos_p[1])
summary(modelos_p[[2]])
summary(modelos_p[[1]])
modelos_p[[1]]$`Pr(>F)`[2]
modelos_p[1]
modelos_p[[1]]$`Pr(>F)`[2]
(((modelos_p[[n]]$`Pr(>F)`[2]) <= 0.05) | (modelos_p[[1]]$`Pr(>F)`[3])<= 0.05)
tukey_loop <- TukeyHSD(modelos_p[[n]])
tukey_loop <- TukeyHSD(modelos_p[n])
tukey_loop <- TukeyHSD(aov(modelos_p[n]))
aov(modelos_p[1])
aov(modelos_p[[1])
aov(modelos_p[[1]])
install.packages("agricolae")
library(agricolae)
modelos_p[4]
?HSD.test()
HSD.test
HSD.test(modelos_p[4], "cultivo + playa")
HSD.test(modelos_p[4], "cultivo")
HSD.test(modelos_p[4], "cultivo", MSerror = deviance(modelos_p[4]/df))
install.packages("emmeans")
library(emmeans)
emmeans()?
?emmeans()
emmeans(modelos_p4, ~cultivo + playa)
emmeans(modelos_p[4], ~cultivo + playa)
modelos_p[4]
modelos_p[[4]
]
emmeans(modelos_p[[4]], ~cultivo + playa)
help("models", package = "emmeans")
emmeans(aov(modelos_p[[4]]), ~cultivo + playa)
aoc(modelos_p[4])
aov(modelos_p[4])
aov(modelos_p[[4]])
modelos_p[1]
modelos_p[[[1]]]
modelos_p[[1]]
as.aov(modelos_p[[1]])
m4 <- aov(GR ~ cultivo + playa, data = filter(data_1, tejido == "Tentaculo"))
HSD.test(m4, "cultivo")
a <- HSD.test(m4, "cultivo")
View(a)
a <- HSD.test(m4, c("cultivo", "playa"))
m4 <- aov(GST ~ cultivo + playa, data = filter(data_1, tejido == "Tentaculo"))
a <- HSD.test(m4, c("cultivo", "playa"))
a <- HSD.test(m4, c("cultivo"))
a <- HSD.test(m4, c("playa"))
a <- HSD.test(m4, c("cultivo", "playa"))
a <- HSD.test(m4, c("playa"))
a$groups$groups
rep(a$groups$groups,2
)
?HSD.test()
a <- HSD.test(m4, c("playa"), unbalanced = T)
a$groups$groups
rep(a$groups$groups,2
)
rep(a$groups$groups,2)
# Rehacemos modelos en clase aov() para el test de tukey
modelos_p <- lapply(colnames(data_1[c(7:16)]), function(x){
aov(formula = as.formula(paste0(x, " ~ cultivo + playa")), filter(data_1, tejido == "Pie"))})
modelos_t <- lapply(colnames(select(data_1, -GPx)[c(7:15)]), function(x){
aov(formula = as.formula(paste0(x, " ~ cultivo + playa")), filter(select(data_1, -GPx), tejido == "Tentaculo"))})
# Transformar log solo GR y G6PDH en tentaculo
modelos_t[[3]] <- aov(log(GR) ~ cultivo + playa, data = filter(data_1, tejido == "Tentaculo"))
modelos_t[[6]] <- aov(log(G6PDH) ~ cultivo + playa, data = filter(data_1, tejido == "Tentaculo"))
HSD.test(modelos_p[n], c("playa"), unbalanced = T)
n <- 4
HSD.test(modelos_p[n], c("playa"), unbalanced = T)
tukey_loop <- HSD.test(modelos_p[[n]], c("playa"), unbalanced = T)
View(tukey_loop)
modelos_p[[4]]
summnary(modelos_p[[4]])
summary(modelos_p[[4]])
n <- 10
tukey_loop <- HSD.test(modelos_p[[n]], c("playa"), unbalanced = T)
tukey_loop$groups$groups
letras <- rep( tukey_loop$groups$groups,2)
colnames(letras) <- c("tratamiento", "tukey")
letras
i <- colnames(data_1[7:16])[[n]]
tabla_summ <- data_1 %>%
filter(tejido == "Pie") %>%   group_by(cultivo, playa) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
View(tabla_summ)
((modelos_p[[1]]$`Pr(>F)`[3])<= 0.05)
((modelos_p[[1]]$`Pr(>F)`[2])<= 0.05)
modelos_p[[n]]
modelos_p[n]
modelos_p[[n]]
(summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1])
(summary(modelos_p[[n]])[[1]][["Pr(>F)"]][2]
)
(summary(modelos_p[[n]])[[1]][["Pr(>F)"]][2])ç
(summary(modelos_p[[n]])[[1]][["Pr(>F)"]][2])
((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][2])<= 0.05)
tukey_loop <- HSD.test(modelos_p[[n]], c("playa"), unbalanced = T)
(letras <- letras <- rep( tukey_loop$groups$groups,2))
tabla_summ&tukey <- letras
tabla_summ$tukey <- letras
ggplot(tabla_summ) +
geom_errorbar(aes(x = cultivo, ymax = media + error, ymin = media- error, group = playa), width = 0.7, color = "gray55") +
geom_col(aes(x = cultivo, fill = playa, y = media, fill = tratamiento)) +
geom_text(aes(x = cultivo, group = playa, y = media + error, label = tukey),
color = "grey5", vjust = -0.5, size = 4) +
ylab(case_when(
i == "proteina" ~ "protein mg / ml",
i == "MDA" ~ "μM  MDA",
i == "TEAC" ~ "Trolox equivalent μM",
i == "GST" ~ "mU / protein mg",
i == "DTD" ~ "mU / protein mg",
TRUE ~ "U / protein mg")) +
xlab("Experimental group") +
#title(main = i) +
scale_fill_manual(values = c("#0c8890", "#3EB59B", "#FBBC4C")) + # Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
#ylim(c(0, case_when(
# i == "CAT.pie" ~  90,
#i == "DTD.pie" ~  15,
#i == "GST.pie" ~  450,
#i == "MDA.pie.2"| i == "MDA.tent.2" ~  80,
#i == "SOD.pie"| i == "SOD.tent" ~  150,
#i == "TEAC.pie"| i == "TEAC.tent" ~  500,
#i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2,
#TRUE ~ max(tabla_summ$media) * 1.2))) +
theme_tfm()
ggplot(tabla_summ) +
geom_errorbar(aes(x = cultivo, ymax = media + error, ymin = media- error, group = playa), width = 0.7, color = "gray55") +
geom_col(aes(x = cultivo, fill = playa, y = media)) +
geom_text(aes(x = cultivo, group = playa, y = media + error, label = tukey),
color = "grey5", vjust = -0.5, size = 4) +
ylab(case_when(
i == "proteina" ~ "protein mg / ml",
i == "MDA" ~ "μM  MDA",
i == "TEAC" ~ "Trolox equivalent μM",
i == "GST" ~ "mU / protein mg",
i == "DTD" ~ "mU / protein mg",
TRUE ~ "U / protein mg")) +
xlab("Experimental group") +
#title(main = i) +
scale_fill_manual(values = c("#0c8890", "#3EB59B", "#FBBC4C")) + # Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
#ylim(c(0, case_when(
# i == "CAT.pie" ~  90,
#i == "DTD.pie" ~  15,
#i == "GST.pie" ~  450,
#i == "MDA.pie.2"| i == "MDA.tent.2" ~  80,
#i == "SOD.pie"| i == "SOD.tent" ~  150,
#i == "TEAC.pie"| i == "TEAC.tent" ~  500,
#i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2,
#TRUE ~ max(tabla_summ$media) * 1.2))) +
theme_tfm()
ggplot(tabla_summ) +
geom_errorbar(aes(x = cultivo, ymax = media + error, ymin = media- error, group = playa), width = 0.7, color = "gray55") +
geom_col(aes(x = cultivo, fill = playa, y = media), position = position_dodge()) +
geom_text(aes(x = cultivo, group = playa, y = media + error, label = tukey),
color = "grey5", vjust = -0.5, size = 4) +
ylab(case_when(
i == "proteina" ~ "protein mg / ml",
i == "MDA" ~ "μM  MDA",
i == "TEAC" ~ "Trolox equivalent μM",
i == "GST" ~ "mU / protein mg",
i == "DTD" ~ "mU / protein mg",
TRUE ~ "U / protein mg")) +
xlab("Experimental group") +
#title(main = i) +
scale_fill_manual(values = c("#0c8890", "#3EB59B", "#FBBC4C")) + # Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
#ylim(c(0, case_when(
# i == "CAT.pie" ~  90,
#i == "DTD.pie" ~  15,
#i == "GST.pie" ~  450,
#i == "MDA.pie.2"| i == "MDA.tent.2" ~  80,
#i == "SOD.pie"| i == "SOD.tent" ~  150,
#i == "TEAC.pie"| i == "TEAC.tent" ~  500,
#i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2,
#TRUE ~ max(tabla_summ$media) * 1.2))) +
theme_tfm()
ggplot(tabla_summ) +
geom_errorbar(aes(x = cultivo, ymax = media + error, ymin = media- error, group = playa), width = 0.7, color = "gray55", position = position_dodge()) +
geom_col(aes(x = cultivo, fill = playa, y = media), position = position_dodge()) +
geom_text(aes(x = cultivo, group = playa, y = media + error, label = tukey),
color = "grey5", vjust = -0.5, size = 4) +
ylab(case_when(
i == "proteina" ~ "protein mg / ml",
i == "MDA" ~ "μM  MDA",
i == "TEAC" ~ "Trolox equivalent μM",
i == "GST" ~ "mU / protein mg",
i == "DTD" ~ "mU / protein mg",
TRUE ~ "U / protein mg")) +
xlab("Experimental group") +
#title(main = i) +
scale_fill_manual(values = c("#0c8890", "#3EB59B", "#FBBC4C")) + # Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
#ylim(c(0, case_when(
# i == "CAT.pie" ~  90,
#i == "DTD.pie" ~  15,
#i == "GST.pie" ~  450,
#i == "MDA.pie.2"| i == "MDA.tent.2" ~  80,
#i == "SOD.pie"| i == "SOD.tent" ~  150,
#i == "TEAC.pie"| i == "TEAC.tent" ~  500,
#i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2,
#TRUE ~ max(tabla_summ$media) * 1.2))) +
theme_tfm()
ggplot(tabla_summ) +
geom_errorbar(aes(x = cultivo, ymax = media + error, ymin = media- error, group = playa), width = 0.7, color = "gray55", position = position_dodge()) +
geom_col(aes(x = cultivo, fill = playa, y = media), position = position_dodge()) +
geom_text(aes(x = cultivo, group = playa, y = media + error, label = tukey),
color = "grey5", vjust = -0.5, size = 4, position = position_dodge()) +
ylab(case_when(
i == "proteina" ~ "protein mg / ml",
i == "MDA" ~ "μM  MDA",
i == "TEAC" ~ "Trolox equivalent μM",
i == "GST" ~ "mU / protein mg",
i == "DTD" ~ "mU / protein mg",
TRUE ~ "U / protein mg")) +
xlab("Experimental group") +
#title(main = i) +
scale_fill_manual(values = c("#0c8890", "#3EB59B", "#FBBC4C")) + # Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
#ylim(c(0, case_when(
# i == "CAT.pie" ~  90,
#i == "DTD.pie" ~  15,
#i == "GST.pie" ~  450,
#i == "MDA.pie.2"| i == "MDA.tent.2" ~  80,
#i == "SOD.pie"| i == "SOD.tent" ~  150,
#i == "TEAC.pie"| i == "TEAC.tent" ~  500,
#i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2,
#TRUE ~ max(tabla_summ$media) * 1.2))) +
theme_tfm()
ggplot(tabla_summ) +
geom_errorbar(aes(x = cultivo, ymax = media + error, ymin = media- error, group = playa), width = 0.7, color = "gray55", position = position_dodge()) +
geom_col(aes(x = cultivo, fill = playa, y = media), position = position_dodge()) +
geom_text(aes(x = cultivo, group = playa, y = media + error, label = tukey),
color = "grey5", size = 4, position = position_dodge()) +
ylab(case_when(
i == "proteina" ~ "protein mg / ml",
i == "MDA" ~ "μM  MDA",
i == "TEAC" ~ "Trolox equivalent μM",
i == "GST" ~ "mU / protein mg",
i == "DTD" ~ "mU / protein mg",
TRUE ~ "U / protein mg")) +
xlab("Experimental group") +
#title(main = i) +
scale_fill_manual(values = c("#0c8890", "#3EB59B", "#FBBC4C")) + # Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
#ylim(c(0, case_when(
# i == "CAT.pie" ~  90,
#i == "DTD.pie" ~  15,
#i == "GST.pie" ~  450,
#i == "MDA.pie.2"| i == "MDA.tent.2" ~  80,
#i == "SOD.pie"| i == "SOD.tent" ~  150,
#i == "TEAC.pie"| i == "TEAC.tent" ~  500,
#i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2,
#TRUE ~ max(tabla_summ$media) * 1.2))) +
theme_tfm()
ggplot(tabla_summ) +
geom_errorbar(aes(x = cultivo, ymax = media + error, ymin = media- error, group = playa), width = 0.7, color = "gray55", position = position_dodge()) +
geom_col(aes(x = cultivo, fill = playa, y = media), position = position_dodge()) +
geom_text(aes(x = cultivo, group = playa, y = media + error, label = tukey),
color = "grey5", vjust = -0.5, size = 4, position = position_dodge(width = 1)) +
ylab(case_when(
i == "proteina" ~ "protein mg / ml",
i == "MDA" ~ "μM  MDA",
i == "TEAC" ~ "Trolox equivalent μM",
i == "GST" ~ "mU / protein mg",
i == "DTD" ~ "mU / protein mg",
TRUE ~ "U / protein mg")) +
xlab("Experimental group") +
#title(main = i) +
scale_fill_manual(values = c("#0c8890", "#3EB59B", "#FBBC4C")) + # Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
#ylim(c(0, case_when(
# i == "CAT.pie" ~  90,
#i == "DTD.pie" ~  15,
#i == "GST.pie" ~  450,
#i == "MDA.pie.2"| i == "MDA.tent.2" ~  80,
#i == "SOD.pie"| i == "SOD.tent" ~  150,
#i == "TEAC.pie"| i == "TEAC.tent" ~  500,
#i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2,
#TRUE ~ max(tabla_summ$media) * 1.2))) +
theme_tfm()
ggplot(tabla_summ) +
geom_errorbar(aes(x = cultivo, ymax = media + error, ymin = media- error, group = playa), width = 0.7, color = "gray55", position = position_dodge(width = 1)) +
geom_col(aes(x = cultivo, fill = playa, y = media), position = position_dodge(width = 1)) +
geom_text(aes(x = cultivo, group = playa, y = media + error, label = tukey),
color = "grey5", vjust = -0.5, size = 4, position = position_dodge(width = 1)) +
ylab(case_when(
i == "proteina" ~ "protein mg / ml",
i == "MDA" ~ "μM  MDA",
i == "TEAC" ~ "Trolox equivalent μM",
i == "GST" ~ "mU / protein mg",
i == "DTD" ~ "mU / protein mg",
TRUE ~ "U / protein mg")) +
xlab("Experimental group") +
#title(main = i) +
scale_fill_manual(values = c("#0c8890", "#3EB59B", "#FBBC4C")) + # Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
#ylim(c(0, case_when(
# i == "CAT.pie" ~  90,
#i == "DTD.pie" ~  15,
#i == "GST.pie" ~  450,
#i == "MDA.pie.2"| i == "MDA.tent.2" ~  80,
#i == "SOD.pie"| i == "SOD.tent" ~  150,
#i == "TEAC.pie"| i == "TEAC.tent" ~  500,
#i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2,
#TRUE ~ max(tabla_summ$media) * 1.2))) +
theme_tfm()
ggplot(tabla_summ) +
geom_errorbar(aes(x = cultivo, ymax = media + error, ymin = media- error, group = playa), width = 0.7, color = "gray55", position = position_dodge(width = 1)) +
geom_col(aes(x = cultivo, fill = playa, y = media), position = position_dodge(width = 1)) +
geom_text(aes(x = cultivo, group = playa, y = media + error, label = tukey),
color = "grey5", vjust = -0.5, size = 4, position = position_dodge(width = 1)) +
ylab(case_when(
i == "proteina" ~ "protein mg / ml",
i == "MDA" ~ "μM  MDA",
i == "TEAC" ~ "Trolox equivalent μM",
i == "GST" ~ "mU / protein mg",
i == "DTD" ~ "mU / protein mg",
TRUE ~ "U / protein mg")) +
xlab("Wild vs Cultured") +
#title(main = i) +
scale_fill_manual(values = c("#0c8890", "#3EB59B", "#FBBC4C")) + # Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
#ylim(c(0, case_when(
# i == "CAT.pie" ~  90,
#i == "DTD.pie" ~  15,
#i == "GST.pie" ~  450,
#i == "MDA.pie.2"| i == "MDA.tent.2" ~  80,
#i == "SOD.pie"| i == "SOD.tent" ~  150,
#i == "TEAC.pie"| i == "TEAC.tent" ~  500,
#i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2,
#TRUE ~ max(tabla_summ$media) * 1.2))) +
theme_tfm()
ggplot(tabla_summ) +
geom_errorbar(aes(x = cultivo, ymax = media + error, ymin = media- error, group = playa), width = 0.7, color = "gray55", position = position_dodge(width = 0.6)) +
geom_col(aes(x = cultivo, fill = playa, y = media), position = position_dodge(width = 0.6)) +
geom_text(aes(x = cultivo, group = playa, y = media + error, label = tukey),
color = "grey5", vjust = -0.5, size = 4, position = position_dodge(width = 0.6)) +
ylab(case_when(
i == "proteina" ~ "protein mg / ml",
i == "MDA" ~ "μM  MDA",
i == "TEAC" ~ "Trolox equivalent μM",
i == "GST" ~ "mU / protein mg",
i == "DTD" ~ "mU / protein mg",
TRUE ~ "U / protein mg")) +
xlab("Wild vs Cultured") +
#title(main = i) +
scale_fill_manual(values = c("#0c8890", "#3EB59B", "#FBBC4C")) + # Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
#ylim(c(0, case_when(
# i == "CAT.pie" ~  90,
#i == "DTD.pie" ~  15,
#i == "GST.pie" ~  450,
#i == "MDA.pie.2"| i == "MDA.tent.2" ~  80,
#i == "SOD.pie"| i == "SOD.tent" ~  150,
#i == "TEAC.pie"| i == "TEAC.tent" ~  500,
#i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2,
#TRUE ~ max(tabla_summ$media) * 1.2))) +
theme_tfm()
ggplot(tabla_summ) +
geom_errorbar(aes(x = cultivo, ymax = media + error, ymin = media- error, group = playa), width = 0.7, color = "gray55", position = position_dodge(width = 0.9)) +
geom_col(aes(x = cultivo, fill = playa, y = media), position = position_dodge(width = 0.9)) +
geom_text(aes(x = cultivo, group = playa, y = media + error, label = tukey),
color = "grey5", vjust = -0.5, size = 4, position = position_dodge(width = 0.9)) +
ylab(case_when(
i == "proteina" ~ "protein mg / ml",
i == "MDA" ~ "μM  MDA",
i == "TEAC" ~ "Trolox equivalent μM",
i == "GST" ~ "mU / protein mg",
i == "DTD" ~ "mU / protein mg",
TRUE ~ "U / protein mg")) +
xlab("Wild vs Cultured") +
#title(main = i) +
scale_fill_manual(values = c("#0c8890", "#3EB59B", "#FBBC4C")) + # Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
#ylim(c(0, case_when(
# i == "CAT.pie" ~  90,
#i == "DTD.pie" ~  15,
#i == "GST.pie" ~  450,
#i == "MDA.pie.2"| i == "MDA.tent.2" ~  80,
#i == "SOD.pie"| i == "SOD.tent" ~  150,
#i == "TEAC.pie"| i == "TEAC.tent" ~  500,
#i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2,
#TRUE ~ max(tabla_summ$media) * 1.2))) +
theme_tfm()
ggplot(tabla_summ) +
geom_errorbar(aes(x = cultivo, ymax = media + error, ymin = media- error, group = playa), width = 0.7, color = "gray55", position = position_dodge(width = 0.9)) +
geom_col(aes(x = cultivo, fill = playa, y = media), position = position_dodge(width = 0.9)) +
geom_text(aes(x = cultivo, group = playa, y = media + error, label = tukey),
color = "grey5", vjust = -0.5, size = 4, position = position_dodge(width = 0.9)) +
ylab(case_when(
i == "proteina" ~ "protein mg / ml",
i == "MDA" ~ "μM  MDA",
i == "TEAC" ~ "Trolox equivalent μM",
i == "GST" ~ "mU / protein mg",
i == "DTD" ~ "mU / protein mg",
TRUE ~ "U / protein mg")) +
xlab("Wild vs Cultured") +
#title(main = i) +
scale_fill_manual(values = c("#0c8890", "#3EB59B", "#F58F29")) + # Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
#ylim(c(0, case_when(
# i == "CAT.pie" ~  90,
#i == "DTD.pie" ~  15,
#i == "GST.pie" ~  450,
#i == "MDA.pie.2"| i == "MDA.tent.2" ~  80,
#i == "SOD.pie"| i == "SOD.tent" ~  150,
#i == "TEAC.pie"| i == "TEAC.tent" ~  500,
#i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2,
#TRUE ~ max(tabla_summ$media) * 1.2))) +
theme_tfm()
for (n in c(1:10)) { ### PIE
i <- colnames(data_1[7:16])[[n]]
tabla_summ <- data_1 %>%
filter(tejido == "Pie") %>%   group_by(cultivo, playa) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][2])<= 0.05) {
tukey_loop <- HSD.test(modelos_p[[n]], c("playa"), unbalanced = T)
(letras <- letras <- rep( tukey_loop$groups$groups,2))
tabla_summ$tukey <- letras
} else {
tabla_summ$tukey <- c("", "", "", "", "", "")
}
(p <- barras_tfg()) # CAMBIAR GRAFICA
ggsave(paste0("./analisis 12-2023/graficas/1/", i, "_pie.png"), width = 800, height = 1000, units = "px", scale = 2, dpi = "retina")
}
source(file = "./analisis 12-2023/0_5_graficas.R")
for (n in c(1:10)) { ### PIE
i <- colnames(data_1[7:16])[[n]]
tabla_summ <- data_1 %>%
filter(tejido == "Pie") %>%   group_by(cultivo, playa) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][2])<= 0.05) {
tukey_loop <- HSD.test(modelos_p[[n]], c("playa"), unbalanced = T)
(letras <- letras <- rep( tukey_loop$groups$groups,2))
tabla_summ$tukey <- letras
} else {
tabla_summ$tukey <- c("", "", "", "", "", "")
}
(p <- barras_tfg()) # CAMBIAR GRAFICA
ggsave(paste0("./analisis 12-2023/graficas/1/", i, "_pie.png"), width = 800, height = 1000, units = "px", scale = 2, dpi = "retina")
}
HSD
?HSD.test
for (n in c(1:9)) { ### TENTACULO
i <- colnames(select(data_1, -GPx)[c(7:15)])[[n]]
tabla_summ <- data_1 %>%
filter(tejido == "Tentaculo") %>%   group_by(cultivo, playa) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos_t[[n]])[[1]][["Pr(>F)"]][2])<= 0.05) {
tukey_loop <- HSD.test(modelos_t[[n]], c("playa"), unbalanced = T)
(letras <- letras <- rep( tukey_loop$groups$groups,2))
tabla_summ$tukey <- letras
} else {
tabla_summ$tukey <- c("", "", "", "", "", "")
}
(p <- barras_tfg()) # CAMBIAR GRAFICA
ggsave(paste0("./analisis 12-2023/graficas/1/", i, "_tent.png"), width = 800, height = 1000, units = "px", scale = 2, dpi = "retina")
}
modelos_p <- lapply(colnames(data_1[c(7:16)]), function(x){
Anova(aov(formula = as.formula(paste0(x, " ~ cultivo * playa")), filter(data_1, tejido == "Pie")), type = 3)})
modelos_t <- lapply(colnames(select(data_1, -GPx)[c(7:15)]), function(x){
Anova(aov(formula = as.formula(paste0(x, " ~ cultivo * playa")), filter(select(data_1, -GPx), tejido == "Tentaculo")), type = 3)})
modelos_p <- lapply(colnames(data_1[c(7:16)]), function(x){
Anova(aov(formula = as.formula(paste0(x, " ~ cultivo * playa")), filter(data_1, tejido == "Pie")), type = 2)})
# Prueba normalidad residuos
m1 <- aov(log(MDA) ~ cultivo * playa, data = filter(data_1, tejido == "Tentaculo"))
summary(m1)
(((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1])<= 0.05)|((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][2]) <= 0.05))
summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1]
summary(modelos_p[[2]])[[1]][["Pr(>F)"]][1]
### TESST POST-HOC ----
# Rehacemos modelos en clase aov() para el test de tukey
modelos_p <- lapply(colnames(data_1[c(7:16)]), function(x){
aov(formula = as.formula(paste0(x, " ~ cultivo + playa")), filter(data_1, tejido == "Pie"))})
modelos_t <- lapply(colnames(select(data_1, -GPx)[c(7:15)]), function(x){
aov(formula = as.formula(paste0(x, " ~ cultivo + playa")), filter(select(data_1, -GPx), tejido == "Tentaculo"))})
modelos_t[[3]] <- aov(log(GR) ~ cultivo + playa, data = filter(data_1, tejido == "Tentaculo"))
modelos_t[[6]] <- aov(log(G6PDH) ~ cultivo + playa, data = filter(data_1, tejido == "Tentaculo"))
(((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1])<= 0.05)|((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][2]) <= 0.05))
n <- 10
(((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][1])<= 0.05)|((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][2]) <= 0.05))
tukey_loop <- TukeyHSD(modelos_p[[n]])
cld.tukey <- multcompLetters4(modelos_p[[n]], tukey_loop, reversed = T)
library(multcompView)
cld.tukey <- multcompLetters4(modelos_p[[n]], tukey_loop, reversed = T)
View(cld.tukey)
((summary(modelos_p[[n]])[[1]][["Pr(>F)"]][2])<= 0.05)
