"Exóticas","Exóticas","Exóticas","Exóticas"),
name = NULL,
values = c("#EE9B00","#EE9B00","#EE9B00","#EE9B00",
"#5b7234","#7b7b7b","#dcdcdc","#b3d374",
"#d55d92","#d55d92","#d55d92","#d55d92")) +
theme_minimal() +
theme(strip.placement = "outside",
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing = unit(0.2,"cm"),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "white", color = NA)) +
guides(color = FALSE) +
xlab("") +
ylab("Nº de especies")
ggsave("grafica_especies.png", width = 5000 , height = 4000, units = "px", scale = 2, dpi = "retina")
?theme_minimal()
# Grafica de numero de especies
(plot_especies <- ggplot(datos_especies) +
geom_col(aes(x = tramo, y = species, group = tipo:tramo, fill = tipo:tramo), position = position_stack()) +
facet_grid(~estacion, switch = "x")) +
scale_fill_manual(labels = c("Amenazadas","Amenazadas","Amenazadas","Amenazadas",
"Tramo 1","Tramo 2","Tramo 3","Tramo 4",
"Exóticas","Exóticas","Exóticas","Exóticas"),
name = NULL,
values = c("#EE9B00","#EE9B00","#EE9B00","#EE9B00",
"#5b7234","#7b7b7b","#dcdcdc","#b3d374",
"#d55d92","#d55d92","#d55d92","#d55d92")) +
theme_light() +
theme(strip.placement = "outside",
strip.background = element_rect(fill = "gray99", color = "white"),
panel.spacing = unit(0.2,"cm"),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "gray99", color = NA)) +
guides(color = FALSE) +
xlab("") +
ylab("Nº de especies")
ggsave("grafica_especies.png", width = 5000 , height = 4000, units = "px", scale = 2, dpi = "retina")
ggsave("grafica_especies.png", width = 4000 , height = 2000, units = "px", scale = 2, dpi = "retina")
# Grafica de numero de especies
(plot_especies <- ggplot(datos_especies) +
geom_col(aes(x = tramo, y = species, group = tipo:tramo, fill = tipo:tramo), position = position_stack()) +
facet_grid(~estacion, switch = "x")) +
scale_fill_manual(labels = c("Amenazadas","Amenazadas","Amenazadas","Amenazadas",
"Tramo 1","Tramo 2","Tramo 3","Tramo 4",
"Exóticas","Exóticas","Exóticas","Exóticas"),
name = NULL,
values = c("#EE9B00","#EE9B00","#EE9B00","#EE9B00",
"#5b7234","#7b7b7b","#dcdcdc","#b3d374",
"#d55d92","#d55d92","#d55d92","#d55d92")) +
theme_minimal() +
theme(strip.placement = "outside",
strip.background = element_rect(fill = "gray99", color = "white"),
panel.spacing = unit(0.2,"cm"),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "gray99", color = NA)) +
guides(color = FALSE) +
xlab("") +
ylab("Nº de especies")
# Grafica de numero de especies
(plot_especies <- ggplot(datos_especies) +
geom_col(aes(x = tramo, y = species, group = tipo:tramo, fill = tipo:tramo), position = position_stack()) +
facet_grid(~estacion, switch = "x")) +
scale_fill_manual(labels = c("Amenazadas","Amenazadas","Amenazadas","Amenazadas",
"Tramo 1","Tramo 2","Tramo 3","Tramo 4",
"Exóticas","Exóticas","Exóticas","Exóticas"),
name = NULL,
values = c("#EE9B00","#EE9B00","#EE9B00","#EE9B00",
"#5b7234","#7b7b7b","#dcdcdc","#b3d374",
"#d55d92","#d55d92","#d55d92","#d55d92")) +
theme_minimal() +
theme(strip.placement = "outside",
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing = unit(0.2,"cm"),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "gray99", color = NA)) +
guides(color = FALSE) +
xlab("") +
ylab("Nº de especies")
# Grafica de numero de individuos
(plot_individuos <- ggplot(datos_individuos) +
geom_col(aes(x = tramo, y = individuos, group = tramo, fill = tipo:tramo), position = position_stack()) +
facet_grid(~estacion, switch = "x")) +
scale_fill_manual(labels = c("Amenazadas","Amenazadas","Amenazadas","Amenazadas",
"Tramo 1","Tramo 2","Tramo 3","Tramo 4",
"Exóticas","Exóticas","Exóticas","Exóticas"),
name = NULL,
values = c("#EE9B00","#EE9B00","#EE9B00","#EE9B00",
"#5b7234","#7b7b7b","#dcdcdc","#b3d374",
"#d55d92","#d55d92","#d55d92","#d55d92")) +
theme_minimal() +
theme(strip.placement = "outside",
strip.background = element_rect(fill = NA, color = "white"),
panel.spacing = unit(0.2,"cm"),
axis.text.x = element_blank()) +
xlab("") +
ylab("Nº de individuos")
# Grafica de numero de individuos
(plot_individuos <- ggplot(datos_individuos) +
geom_col(aes(x = tramo, y = individuos, group = tramo, fill = tipo:tramo), position = position_stack()) +
facet_grid(~estacion, switch = "x")) +
scale_fill_manual(labels = c("Amenazadas","Amenazadas","Amenazadas","Amenazadas",
"Tramo 1","Tramo 2","Tramo 3","Tramo 4",
"Exóticas","Exóticas","Exóticas","Exóticas"),
name = NULL,
values = c("#EE9B00","#EE9B00","#EE9B00","#EE9B00",
"#5b7234","#7b7b7b","#dcdcdc","#b3d374",
"#d55d92","#d55d92","#d55d92","#d55d92")) +
theme_minimal() +
theme(strip.placement = "outside",
strip.background = element_rect(fill = NA, color = "white"),
panel.spacing = unit(0.2,"cm"),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "gray99", color = NA)) +
xlab("") +
ylab("Nº de individuos")
# Grafica de numero de individuos
(plot_individuos <- ggplot(datos_individuos) +
geom_col(aes(x = tramo, y = individuos, group = tipo:tramo, fill = tipo:tramo), position = position_stack()) +
facet_grid(~estacion, switch = "x")) +
scale_fill_manual(labels = c("Amenazadas","Amenazadas","Amenazadas","Amenazadas",
"Tramo 1","Tramo 2","Tramo 3","Tramo 4",
"Exóticas","Exóticas","Exóticas","Exóticas"),
name = NULL,
values = c("#EE9B00","#EE9B00","#EE9B00","#EE9B00",
"#5b7234","#7b7b7b","#dcdcdc","#b3d374",
"#d55d92","#d55d92","#d55d92","#d55d92")) +
theme_minimal() +
theme(strip.placement = "outside",
strip.background = element_rect(fill = NA, color = "white"),
panel.spacing = unit(0.2,"cm"),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "gray99", color = NA)) +
xlab("") +
ylab("Nº de individuos")
# Grafica de numero de especies
(plot_especies <- ggplot(datos_especies) +
geom_col(aes(x = tramo, y = species, group = tipo:tramo, fill = tipo:tramo), position = position_stack()) +
facet_grid(~estacion, switch = "x")) +
scale_fill_manual(labels = c("Amenazadas","Amenazadas","Amenazadas","Amenazadas",
"Tramo 1","Tramo 2","Tramo 3","Tramo 4",
"Exóticas","Exóticas","Exóticas","Exóticas"),
name = NULL,
values = c("#EE9B00","#EE9B00","#EE9B00","#EE9B00",
"#5b7234","#7b7b7b","#dcdcdc","#b3d374",
"#d55d92","#d55d92","#d55d92","#d55d92")) +
theme_minimal() +
theme(strip.placement = "outside",
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing = unit(0.2,"cm"),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "gray99", color = NA)) +
guides(color = FALSE) +
xlab("") +
ylab("Promedio de número de especies")
# Grafica de numero de individuos
(plot_individuos <- ggplot(datos_individuos) +
geom_col(aes(x = tramo, y = individuos, group = tipo:tramo, fill = tipo:tramo), position = position_stack()) +
facet_grid(~estacion, switch = "x")) +
scale_fill_manual(labels = c("Amenazadas","Amenazadas","Amenazadas","Amenazadas",
"Tramo 1","Tramo 2","Tramo 3","Tramo 4",
"Exóticas","Exóticas","Exóticas","Exóticas"),
name = NULL,
values = c("#EE9B00","#EE9B00","#EE9B00","#EE9B00",
"#5b7234","#7b7b7b","#dcdcdc","#b3d374",
"#d55d92","#d55d92","#d55d92","#d55d92")) +
theme_minimal() +
theme(strip.placement = "outside",
strip.background = element_rect(fill = NA, color = "white"),
panel.spacing = unit(0.2,"cm"),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "gray99", color = NA)) +
xlab("") +
ylab("Promedio de número de individuos")
### Graficas para Aitana
# 24/10/2023 - 27/10/2023
### Setup y cargar datos ----
# IMPORTANTE: SI NO TIENES INSTALADOS ESTOS PAQUETES, INSTALALOS PRIMERO ANTES DE CARGARLOS
#install.packages("tidyverse")
library(tidyverse)
setwd("D:/collf/Documents") # Aqui tienes que poner la direccion de carpeta donde tienes los datos o quiras guardar el archivo y las graficas
datos <- read.csv2("graficas aitana.csv", encoding = "latin1", dec = ".")
summary(datos) # Aqui pones el nombre del archivo con los datos, o pones "clipboard" para pegarlos como me enseñaste. Asegurate que el separador decimal (dec) esta bien
# Cambiar el tipo de variable y ordenar los niveles
datos$estacion <- as.factor(datos$estacion)
datos$tramo <- as.factor(datos$tramo)
datos$estacion <- ordered(datos$estacion, levels = c("OTOÑO", "INVIERNO", "PRIMAVERA", "VERANO"))
### Cambiar a formato largo ----
# Necesitamos una nueva variable (tipo), que pueda tomar los valores promedio, exotica o amenazada. La función gather() del paquete tidyr hace esto
# Lo hago separando los datos de especies e individuos porque no me apetece pensar
datos_especies <- gather(datos, key = tipo, value = species, sp_promedio:sp_amenzadas) %>% select(estacion, tramo, tipo, species)
datos_especies$tipo <- as.factor(datos_especies$tipo)
datos_especies$tipo <- factor(datos_especies$tipo, levels = c("sp_amenzadas", "sp_promedio", "sp_exoticas"))
datos_individuos <- gather(datos, key = tipo, value = individuos, ind_promedio:ind_amenazadas) %>% select(estacion, tramo, tipo, individuos)
datos_individuos$tipo <- as.factor(datos_individuos$tipo)
datos_individuos$tipo <- factor(datos_individuos$tipo, levels = c("ind_amenazadas", "ind_promedio", "ind_exoticas"))
### Graficas ----
# PARA CAMBIAR COLORES: donde pone values = c(....), estan los 12 colores ordenados. La primera y ultima fila son para amenazadas y para exóticas, pero le tienes que poner el mismo color 4 veces. La fila de en medio para los tramos, ordenados del 1 al 4.
# Para cambiar el color necesitas solo el codigo hex del color y lo pones, importante no borrar las comillas.
# Grafica de numero de especies
(plot_especies <- ggplot(datos_especies) +
geom_col(aes(x = tramo, y = species, group = tipo:tramo, fill = tipo:tramo), position = position_stack()) +
facet_grid(~estacion, switch = "x")) +
scale_fill_manual(labels = c("Amenazadas","Amenazadas","Amenazadas","Amenazadas",
"Tramo 1","Tramo 2","Tramo 3","Tramo 4",
"Exóticas","Exóticas","Exóticas","Exóticas"),
name = NULL,
values = c("#EE9B00","#EE9B00","#EE9B00","#EE9B00",
"#5b7234","#7b7b7b","#dcdcdc","#b3d374",
"#d55d92","#d55d92","#d55d92","#d55d92")) +
theme_minimal() +
theme(strip.placement = "outside",
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing = unit(0.2,"cm"),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "gray99", color = NA)) +
guides(color = FALSE) +
xlab("") +
ylab("Promedio de número de especies")
# Grafica de numero de especies
(plot_especies <- ggplot(datos_especies) +
geom_col(aes(x = tramo, y = species, group = tipo:tramo, fill = tipo:tramo), position = position_stack()) +
facet_grid(~estacion, switch = "x")) +
scale_fill_manual(labels = c("Amenazadas","Amenazadas","Amenazadas","Amenazadas",
"Tramo 1","Tramo 2","Tramo 3","Tramo 4",
"Exóticas","Exóticas","Exóticas","Exóticas"),
name = NULL,
values = c("#EE9B00","#EE9B00","#EE9B00","#EE9B00",
"#5b7234","#7b7b7b","#dcdcdc","#b3d374",
"#d55d92","#d55d92","#d55d92","#d55d92")) +
theme_minimal() +
theme(strip.placement = "outside",
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing = unit(0.2,"cm"),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "gray99", color = NA)) +
xlab("") +
ylab("Promedio de número de especies")
# Grafica de numero de individuos
(plot_individuos <- ggplot(datos_individuos) +
geom_col(aes(x = tramo, y = individuos, group = tipo:tramo, fill = tipo:tramo), position = position_stack()) +
facet_grid(~estacion, switch = "x")) +
scale_fill_manual(labels = c("Amenazadas","Amenazadas","Amenazadas","Amenazadas",
"Tramo 1","Tramo 2","Tramo 3","Tramo 4",
"Exóticas","Exóticas","Exóticas","Exóticas"),
name = NULL,
values = c("#EE9B00","#EE9B00","#EE9B00","#EE9B00",
"#5b7234","#7b7b7b","#dcdcdc","#b3d374",
"#d55d92","#d55d92","#d55d92","#d55d92")) +
theme_minimal() +
theme(strip.placement = "outside",
strip.background = element_rect(fill = NA, color = "white"),
panel.spacing = unit(0.2,"cm"),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "gray99", color = NA)) +
xlab("") +
ylab("Promedio de número de individuos")
setwd("D:/collf/Documents/DATOS ISMAEL.csv")
setwd("D:/collf/Documents")
datos <- read.csv2("./DATOS ISMAEL.csv", numerals = "warn.loss", encoding = "latin1")%>%
mutate(tratamiento = as.factor(tratamiento))
ibrary(tidyverse)
datos <- read.csv2("./DATOS ISMAEL.csv", numerals = "warn.loss", encoding = "latin1")%>%
mutate(tratamiento = as.factor(tratamiento))
library(tidyverse)
datos <- read.csv2("./DATOS ISMAEL.csv", numerals = "warn.loss", encoding = "latin1")%>%
mutate(tratamiento = as.factor(tratamiento))
datos <- read.csv2("./DATOS ISMAEL.csv", numerals = "warn.loss", encoding = "latin1")%>%
mutate(Tratamiento = as.factor(Tratamiento))
View(datos)
## Definicion del tema y formato de las graficas ----
theme_tfm <- function(){
theme(panel.background = element_rect(fill = "gray99"),
axis.text = element_text(size = 9),
plot.title = element_text(size = 14, face = "bold", hjust = 1),
strip.text.x = element_text(size = 12, face = "bold", vjust = 0),
axis.title = element_text(size = 12),
legend.position = "none",
panel.grid = element_blank(),
axis.line = element_line(colour = "gray10"),
axis.ticks = element_line(color = "gray10"))
#strip.background = element_rect(colour = "black")
}
p_sod <- ggplot(datos, aes(x = Tratamiento, y = SOD)) +
geom_col()
(p_sod <- ggplot(datos, aes(x = Tratamiento, y = SOD)) +
geom_col()
)
(p_sod <- ggplot(datos, aes(x = Tratamiento, y = SOD)) +
geom_errorbar(aes(ymax = SOD + SEM_SOD, ymin = SOD - SEM_SOD)) +
geom_col() +
)
(p_sod <- ggplot(datos, aes(x = Tratamiento, y = SOD)) +
geom_errorbar(aes(ymax = SOD + SEM_SOD, ymin = SOD - SEM_SOD)) +
geom_col() +
)
ggplot(datos, aes(x = Tratamiento, y = SOD)) +
geom_errorbar(aes(ymax = SOD + SEM_SOD, ymin = SOD - SEM_SOD)) +
geom_col()
GEOM_ERRORBAR()
?geom_errorbar()
ggplot(datos, aes(x = Tratamiento, y = SOD)) +
geom_errorbar(aes(ymax = (SOD + SEM_SOD), ymin = (SOD - SEM_SOD))) +
geom_col()
summary(datos)
?read.csv2()
datos <- read.csv2("./DATOS ISMAEL.csv", numerals = "warn.loss", encoding = "latin1", colClasses = "numeric")%>%
mutate(Tratamiento = as.factor(Tratamiento))
as.numeric(SOD)
as.numeric(datos$SOD)
ggplot(datos, aes(x = Tratamiento, y = as.numeric(SOD))) +
geom_errorbar(aes(ymax = as.numeric(SOD) +as.numeric(SEM_SOD), ymin = as.numeric(SOD)-as.numeric(SEM_SOD))) +
geom_col()
library(tidyverse)
library(car)
library(multcompView)
library(patchwork)
library(rstatix)
library(ggpubr)
posthoc <- function(){
if (any(filter(as.tibble(anova_results), variable == i)$p.adj <= 0.05, na.rm = T)){
print("There is at least one significative effect")
if (filter(as.tibble(anova_results), variable == i)$p.adj[3] <= 0.05){
print("Interaction is significative")
}
else{
print("Interaction is not significative")
if (any(filter(as.tibble(anova_results), variable == i)$p.adj[-3] <= 0.05, na.rm = F)){
print("One main effect is significative")
}
else{
print("Two main effects are significative")
}
}
}
else{print("There is no significative effects")}
}
setwd("D:/collf/Documents")
datos <- read.csv2(".ismael.csv")
datos <- read.csv2("ismael.csv")
View(datos)
datos <- read.csv2("ismael.csv") %>%
t.test(datos)
datos <- read.csv2("ismael.csv") %>%
t.test(datos)
t.test(datos)
(a <- t.test(datos))
?t.test()
(a <- t.test(valor ~ tratamiento, data =datos))
View(datos)
(a <- t.test(valor ~ tratamietno, data =datos))
View(datos)
summary(datos)
library(tidyverse)
datos <- read.csv2("ismael.csv")
datos <- read.csv2("ismael.csv") %>%
datos <- read.csv2("ismael.csv") %>%
mutate(valor = as.numeric(valor), tratamietno = as.factor(tratamietno))
(a <- t.test(valor ~ tratamietno, data =datos))
library(tidyverse)
library(multcompView)
library(car)
library(rstatix)
library(gt)
library(patchwork)
### SETUP y filtrado de datos ----
#setwd("C:/Users/Usuario/Documents/GitHub/Revision_datos_TFG")
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
#source(file = "./scripts septiembre 2024-2025/0_data_lab.R")
source(file = "./scripts septiembre 2024-2025/0_data_laptop.R")
source(file = "./scripts septiembre 2024-2025/1_funciones_graficas.R")
# Filtrar: solo anemonas cultivadas
data_2 <- filter(datos, cultivo == "cultured")
### Exploracion ----
ggplot(data_2, aes(y = Fbasica_p)) +
geom_boxplot(aes(x = time:section, color = time:section), alpha = 0) +
geom_point(aes(x = time:section, color = time:section), alpha = 1, size = 2)
# Deteccion de outliers
view(data_2 %>%  group_by(section:time) %>%  identify_outliers(GPx_t))
data_2$GPx_t[9] <- NA # Afecta a homcedasticidad y es extremo
data_2$GPx_t[6] <- NA #HOMOCEDASTICIDAD
data_2$GPx_t[2] <- NA
data_2$GPx_t[33] <- NA #posible
data_2$GPx_t[4] <- NA # Quitar el otro dato  #4 para l GPx tentacular
data_2$GPx_p[2] <- NA # outlier extremo
data_2$GPx_p[15] <- NA # extremo
data_2$GPx_p[17] <- NA
data_2$GPx_p[30] <- NA
data_2$GPx_p[33] <- NA
# Se eliminan:
data_2$SOD_t[7] <- NA #para normalidad
data_2$SOD_t[3] <- NA #para normalidad
# Quitar la  #35 tambien
data_2$CAT_t[35] <- NA # La funcion ha identificado otro, pero su eliminacion no afecta a la normalidad de residuos, este si.
data_2$Mielo_p[26] <- NA
data_2$Mielo_t[18] <- NA #Sospechoso, y afecta a normalidad
data_2$Facida_p[30] # sospechoso, outlier no extremo
data_2$Fbasica_p[12] <- NA # outlier extremo
data_2$Fbasica_p[15] # incrementa mucho error pero no se puede quitar porque violaria homocedasticidad
data_2$Fbasica_t[9] <- NA # Afecta a homocedasticidad
data_2$Lisozima_p[33] <- NA # outlier extremo
data_2$Lisozima_p[34] <- NA # outlier extremo
data_2$Lisozima_p[2] <- NA # outlier extremo
data_2$MDA_p[29] <- NA # Outlier no extremo pero parece que puede afectar al resultado del analisis y afecta a la varianza del grupo.
### Ajuste de modelos ----
# Si se elimina alguna enzima al final, eliminarla aquí
#data_2 <- data_2 %>%   select(-Lisozima_p, -GPx_t, -GPx_p)
# Ajuste de modelos ANOVA con rstatix
modelos <- lapply(colnames(data_2[c(5:31)]), function(x){
anova_test(formula = as.formula(paste0(x, " ~ section * time")), data_2)})
(anova_results <- reduce(modelos, full_join) %>%
add_column(.before = 1, variable = rep(colnames(data_2[c(5:31)]), each = 3)) %>%
adjust_pvalue(method = "BH"))
# Test de Levene se computa exactamente igual
modelos_levene <- lapply(colnames(data_2[c(5:31)]), function(x){
levene_test(formula = as.formula(paste0(x, " ~ section * time")), data_2)})
(levene_results <- reduce(modelos_levene, full_join) %>%
add_column(.before = 1, variable = colnames(data_2[c(5:31)])))
# Para el test de Shapiro-Wilks se ajustan lm para extraer residuos
modelos_lm <- lapply(colnames(data_2[c(5:31)]), function(x){
lm(formula = as.formula(paste0(x, " ~ section * time")), data_2)})
modelos_shapiro <- lapply(modelos_lm, function(x){
shapiro_test(residuals(x))})
(shapiro_results <- reduce(modelos_shapiro, full_join) %>%
add_column(.before = 1, parametro = colnames(data_2[c(5:31)])))
# Sin filtrar, no se cumple normalidad de residuos en el caso de:
# SOD_t (solucionado), CAT_t (solucionado), Fbasica_p (solucionado), Mielo_p (solucionado), Mielo_t (solucionado), lisozima_p (solucionado)
# No hay homocedasticidad en:
# Fbasica_t (solucionado), GPx_t (solucionado)
posthoc_tree <- function(){
letras <- c("", "", "", "")
pvalues <- filter(as_tibble(anova_results), variable == i)$p.adj
if (any(pvalues <= 0.05, na.rm = T)){
if (pvalues[3] <= 0.05){
t.results <-data_2 %>%
group_by(time) %>%
t_test(as.formula(paste0(i, " ~ section")), p.adjust.method = "BH")
if(t.results[1,]$p <= 0.05){
letras[c(1,3)] <- c("", "*")}
if(t.results[2,]$p <= 0.05){
letras[c(2,4)] <- c("", "*")}
#Se pueden añadir tiers con case_when()
print("Interacion is significant. Grouped t-test performed.")
return(letras)
}
else{
letras <- case_when(
pvalues[1] <= 0.05 & pvalues[2] <= 0.05 ~ c("b", "a", "c", "b"),
pvalues[1] <= 0.05 & tabla_summ[1,]$mean < tabla_summ[3,]$mean ~ c("a", "a", "b", "b"),
pvalues[1] <= 0.05 & tabla_summ[1,]$mean > tabla_summ[3,]$mean~ c("b", "b", "a", "a"),
pvalues[2] <= 0.05 & tabla_summ[1,]$mean < tabla_summ[2,]$mean ~ c("a", "b", "a", "b"),
pvalues[2] <= 0.05 & tabla_summ[1,]$mean > tabla_summ[2,]$mean~ c("b", "a", "b", "a"))
print("Interacion is not significant. Simple main effects computed.")
return(letras)}}
else{
print("There is no significative effects")
return(letras)}
}
table_maker <- function(){
t <- anova_results %>% as_tibble() %>%
filter(variable == i) %>%
select(-variable, -DFn, -DFd, -p, -`p<.05`, -ges) %>%
mutate(sign. = case_when(
p.adj <= 0.001 ~ "***",
p.adj <= 0.01 ~ "**",
p.adj <= 0.05 ~ "*",
TRUE ~ "ns"),
p.adj = trunc(p.adj*10^4)/10^4) %>%
gt() %>%
cols_label(
Effect = md("**Effect**"),
`F` = md("**F statistic**"),
p.adj = md("**p value**"),
sign. = md("")) %>%
tab_header(title = md("Two-way ANOVA Table")) %>%
tab_options(
heading.title.font.size = "medium",
#column_labels.font.weight = "bold",
table.font.size = "small",
column_labels.font.size = "medium") %>%
tab_style(
style = cell_text(color = "red3", weight = "normal"),
locations = cells_body(
columns = c(p.adj, sign.),
rows = p.adj <= 0.05))
return(t)
} # My beautiful beautiful daughter Table_maker()
View(datos)
i <- 6
i <- colnames(data_2[5:31])[[n]]
n <- 6
i <- colnames(data_2[5:31])[[n]]
tabla_summ <- data_2 %>% group_by(section:time) %>%
get_summary_stats(i, type = "mean_se") %>%
separate_wider_delim(`section:time`, ":", names = c("tratamiento", "time"), cols_remove=F)
if((n %% 2) != 0) {# Memoria del limite
limite_t = 1.3*(max(tabla_summ$mean) + max(tabla_summ$se))}
tabla_summ$letras <- posthoc_tree()
n <- 5
i <- colnames(data_2[5:31])[[n]]
tabla_summ <- data_2 %>% group_by(section:time) %>%
get_summary_stats(i, type = "mean_se") %>%
separate_wider_delim(`section:time`, ":", names = c("tratamiento", "time"), cols_remove=F)
if((n %% 2) != 0) {# Memoria del limite
limite_t = 1.3*(max(tabla_summ$mean) + max(tabla_summ$se))}
tabla_summ$letras <- posthoc_tree()
t.results <-data_2 %>%
group_by(time) %>%
t_test(as.formula(paste0(i, " ~ section")), p.adjust.method = "BH")
View(t.results)
0.00995 <0.05
0.00995 <0.001
0.02860 <0.001
