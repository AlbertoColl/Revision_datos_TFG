# Lo hago separando los datos de especies e individuos porque no me apetece pensar
datos_especies <- gather(datos, key = tipo, value = species, sp_promedio:sp_amenzadas) %>% select(estacion, tramo, tipo, species)
datos_especies$tipo <- as.factor(datos_especies$tipo)
datos_especies$tipo <- factor(datos_especies$tipo, levels = c("sp_amenzadas", "sp_promedio", "sp_exoticas"))
datos_individuos <- gather(datos, key = tipo, value = individuos, ind_promedio:ind_amenazadas) %>% select(estacion, tramo, tipo, individuos)
datos_individuos$tipo <- as.factor(datos_individuos$tipo)
datos_individuos$tipo <- factor(datos_individuos$tipo, levels = c("ind_amenazadas", "ind_promedio", "ind_exoticas"))
### Graficas ----
# PARA CAMBIAR COLORES: donde pone values = c(....), estan los 12 colores ordenados. La primera y ultima fila son para amenazadas y para exóticas, pero le tienes que poner el mismo color 4 veces. La fila de en medio para los tramos, ordenados del 1 al 4.
# Para cambiar el color necesitas solo el codigo hex del color y lo pones, importante no borrar las comillas.
# Grafica de numero de especies
(plot_especies <- ggplot(datos_especies) +
geom_col(aes(x = tramo, y = species, group = tipo:tramo, fill = tipo:tramo), position = position_stack()) +
facet_grid(~estacion, switch = "x")) +
scale_fill_manual(labels = c("Amenazadas","Amenazadas","Amenazadas","Amenazadas",
"Tramo 1","Tramo 2","Tramo 3","Tramo 4",
"Exóticas","Exóticas","Exóticas","Exóticas"),
name = NULL,
values = c("#EE9B00","#EE9B00","#EE9B00","#EE9B00",
"#5b7234","#7b7b7b","#dcdcdc","#b3d374",
"#d55d92","#d55d92","#d55d92","#d55d92")) +
theme_minimal() +
theme(strip.placement = "outside",
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing = unit(0.2,"cm"),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "gray99", color = NA)) +
guides(color = FALSE) +
xlab("") +
ylab("Promedio de número de especies")
# Grafica de numero de especies
(plot_especies <- ggplot(datos_especies) +
geom_col(aes(x = tramo, y = species, group = tipo:tramo, fill = tipo:tramo), position = position_stack()) +
facet_grid(~estacion, switch = "x")) +
scale_fill_manual(labels = c("Amenazadas","Amenazadas","Amenazadas","Amenazadas",
"Tramo 1","Tramo 2","Tramo 3","Tramo 4",
"Exóticas","Exóticas","Exóticas","Exóticas"),
name = NULL,
values = c("#EE9B00","#EE9B00","#EE9B00","#EE9B00",
"#5b7234","#7b7b7b","#dcdcdc","#b3d374",
"#d55d92","#d55d92","#d55d92","#d55d92")) +
theme_minimal() +
theme(strip.placement = "outside",
strip.background = element_rect(fill = "white", color = "white"),
panel.spacing = unit(0.2,"cm"),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "gray99", color = NA)) +
xlab("") +
ylab("Promedio de número de especies")
# Grafica de numero de individuos
(plot_individuos <- ggplot(datos_individuos) +
geom_col(aes(x = tramo, y = individuos, group = tipo:tramo, fill = tipo:tramo), position = position_stack()) +
facet_grid(~estacion, switch = "x")) +
scale_fill_manual(labels = c("Amenazadas","Amenazadas","Amenazadas","Amenazadas",
"Tramo 1","Tramo 2","Tramo 3","Tramo 4",
"Exóticas","Exóticas","Exóticas","Exóticas"),
name = NULL,
values = c("#EE9B00","#EE9B00","#EE9B00","#EE9B00",
"#5b7234","#7b7b7b","#dcdcdc","#b3d374",
"#d55d92","#d55d92","#d55d92","#d55d92")) +
theme_minimal() +
theme(strip.placement = "outside",
strip.background = element_rect(fill = NA, color = "white"),
panel.spacing = unit(0.2,"cm"),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "gray99", color = NA)) +
xlab("") +
ylab("Promedio de número de individuos")
setwd("D:/collf/Documents/DATOS ISMAEL.csv")
setwd("D:/collf/Documents")
datos <- read.csv2("./DATOS ISMAEL.csv", numerals = "warn.loss", encoding = "latin1")%>%
mutate(tratamiento = as.factor(tratamiento))
ibrary(tidyverse)
datos <- read.csv2("./DATOS ISMAEL.csv", numerals = "warn.loss", encoding = "latin1")%>%
mutate(tratamiento = as.factor(tratamiento))
library(tidyverse)
datos <- read.csv2("./DATOS ISMAEL.csv", numerals = "warn.loss", encoding = "latin1")%>%
mutate(tratamiento = as.factor(tratamiento))
datos <- read.csv2("./DATOS ISMAEL.csv", numerals = "warn.loss", encoding = "latin1")%>%
mutate(Tratamiento = as.factor(Tratamiento))
View(datos)
## Definicion del tema y formato de las graficas ----
theme_tfm <- function(){
theme(panel.background = element_rect(fill = "gray99"),
axis.text = element_text(size = 9),
plot.title = element_text(size = 14, face = "bold", hjust = 1),
strip.text.x = element_text(size = 12, face = "bold", vjust = 0),
axis.title = element_text(size = 12),
legend.position = "none",
panel.grid = element_blank(),
axis.line = element_line(colour = "gray10"),
axis.ticks = element_line(color = "gray10"))
#strip.background = element_rect(colour = "black")
}
p_sod <- ggplot(datos, aes(x = Tratamiento, y = SOD)) +
geom_col()
(p_sod <- ggplot(datos, aes(x = Tratamiento, y = SOD)) +
geom_col()
)
(p_sod <- ggplot(datos, aes(x = Tratamiento, y = SOD)) +
geom_errorbar(aes(ymax = SOD + SEM_SOD, ymin = SOD - SEM_SOD)) +
geom_col() +
)
(p_sod <- ggplot(datos, aes(x = Tratamiento, y = SOD)) +
geom_errorbar(aes(ymax = SOD + SEM_SOD, ymin = SOD - SEM_SOD)) +
geom_col() +
)
ggplot(datos, aes(x = Tratamiento, y = SOD)) +
geom_errorbar(aes(ymax = SOD + SEM_SOD, ymin = SOD - SEM_SOD)) +
geom_col()
GEOM_ERRORBAR()
?geom_errorbar()
ggplot(datos, aes(x = Tratamiento, y = SOD)) +
geom_errorbar(aes(ymax = (SOD + SEM_SOD), ymin = (SOD - SEM_SOD))) +
geom_col()
summary(datos)
?read.csv2()
datos <- read.csv2("./DATOS ISMAEL.csv", numerals = "warn.loss", encoding = "latin1", colClasses = "numeric")%>%
mutate(Tratamiento = as.factor(Tratamiento))
as.numeric(SOD)
as.numeric(datos$SOD)
ggplot(datos, aes(x = Tratamiento, y = as.numeric(SOD))) +
geom_errorbar(aes(ymax = as.numeric(SOD) +as.numeric(SEM_SOD), ymin = as.numeric(SOD)-as.numeric(SEM_SOD))) +
geom_col()
library(tidyverse)
library(car)
library(multcompView)
library(patchwork)
library(rstatix)
library(ggpubr)
posthoc <- function(){
if (any(filter(as.tibble(anova_results), variable == i)$p.adj <= 0.05, na.rm = T)){
print("There is at least one significative effect")
if (filter(as.tibble(anova_results), variable == i)$p.adj[3] <= 0.05){
print("Interaction is significative")
}
else{
print("Interaction is not significative")
if (any(filter(as.tibble(anova_results), variable == i)$p.adj[-3] <= 0.05, na.rm = F)){
print("One main effect is significative")
}
else{
print("Two main effects are significative")
}
}
}
else{print("There is no significative effects")}
}
setwd("D:/collf/Documents")
datos <- read.csv2(".ismael.csv")
datos <- read.csv2("ismael.csv")
View(datos)
datos <- read.csv2("ismael.csv") %>%
t.test(datos)
datos <- read.csv2("ismael.csv") %>%
t.test(datos)
t.test(datos)
(a <- t.test(datos))
?t.test()
(a <- t.test(valor ~ tratamiento, data =datos))
View(datos)
(a <- t.test(valor ~ tratamietno, data =datos))
View(datos)
summary(datos)
library(tidyverse)
datos <- read.csv2("ismael.csv")
datos <- read.csv2("ismael.csv") %>%
datos <- read.csv2("ismael.csv") %>%
mutate(valor = as.numeric(valor), tratamietno = as.factor(tratamietno))
(a <- t.test(valor ~ tratamietno, data =datos))
library(dplyr)
library(readr)
df <- list.files(path="C:/Users/collf/Desktop/csv_epiteliales_azules/", full.names = TRUE) %>%
lapply(read_csv) %>%
bind_rows
View(df)
# Esto es para guardarlo como csv.
# Acuerdate de poner el nombre de archivo.csv al final
write.csv(df, "C:/Users/collf/Desktop/csv_epiteliales_azules/conteo.csv", row.names = F)
read.csv("D:/collf/Documents/GELES.csv")
data <- read.csv("D:/collf/Documents/GELES.csv")
View(data)
data <- read.csv2("D:/collf/Documents/GELES.csv")
library(dplyr)
summary(data)
?read.csv2
data <- read.csv2("D:/collf/Documents/GELES.csv", dec = ".")
summary(data)
?t.test()
t.test(AvVASA ~ tratamiento, data = data)
t.ca2mg <- t.test(AvCA2Mg ~ tratamiento, data = data)
(t.ca2mg <- t.test(AvCA2Mg ~ tratamiento, data = data))
(t.pl10 <- t.test(AvPl10 ~ tratamiento, data = data))
(t.pl10 <- t.test(AvPL10 ~ tratamiento, data = data))
(t.gfp <- t.test(AvGFP ~ tratamiento, data = data))
summary(t.ca2mg)
t.vasa
# T-test para las cuatro variables
(t.vasa <- t.test(AvVASA ~ tratamiento, data = data))
t.vasa
# Asunciones
shapiro.test(data$AvVASA)
shapiro.test(data$AvCA2Mg)
shapiro.test(data$AvPL10)
plot(t.vasa)
shapiro.test(data$AvGFP)
library(car)
# Asuncion de homocedasticidad
leveneTest(data$AvVASA)
# Asuncion de homocedasticidad
leveneTest(data$AvVASA, group = tratamiento)
# Asuncion de homocedasticidad
leveneTest(data$AvVASA, group = data$tratamiento)
leveneTest(data$AvCA2Mg, group = data$tratamiento)
leveneTest(data$AvPL10, group = data$tratamiento)
leveneTest(data$AvGFP, group = data$tratamiento)
library(tidyverse)
library(psych)
library(MVN)
library(factoextra)
library(ggpubr)
library(tidyverse)
library(psych)
library(MVN)
library(factoextra)
library(ggpubr)
library(patchwork)
library(PCAtest)
library(GGally)
# SETUP y Carga de datos ----
#setwd("C:/Users/Usuario/Documents/GitHub/Revision_datos_TFG")
setwd("D:/collf/Documents/GitHub/Revision_datos_TFG")
source(file = "./scripts septiembre 2024-2025/0_lectura.R")
datos_2 <- datos_long %>%  filter(cultivo == "Si")
# PCA columnar ----
datos_pca_p <- datos_2 %>% filter(tejido == "Pie") %>%
select(c(6:18), -proteina, -G6PDH)
colnames(datos_pca_p) <- c("SOD", "CAT", "GPx", "GR", "GST", "DTD", "TEAC", "MDA", "Acid.phospatase", "Alkaline.phosphatase", "MPx")
ggpairs(datos_pca_p)
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_p)
# Test complementarios
KMO(datos_pca_p) # Overall MSA =  0.5
cortest.bartlett(datos_pca_p, nrow(datos_pca_p)) # p value =  5.141975e-10
mvn(datos_pca_p, mvn = "mardia") # Hay normalidad multivariable. Los componentes principales son independientes
pc_pie <- princomp(~., data = as.data.frame(datos_pca_p), cor = TRUE)
summary(pc_pie)
(biplot_p <- fviz_pca_biplot(pc_pie, col.ind = na.omit(select(filter(datos_2, tejido == "Pie"), -Lisozima, -G6PDH))$section:na.omit(select(filter(datos_2, tejido == "Pie"), -Lisozima, -G6PDH))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(c1 <- fviz_contrib(pc_pie, choice = "var", axes = 1, sort.val = "desc") + ylab("Contribution %") + labs(title = "Contribution of variables to PC1") +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size = 12)))
(c2 <- fviz_contrib(pc_pie, choice = "var", axes = 2, sort.val = "desc") + ylab("Contribution %") + labs(title = "Contribution of variables to PC2") +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size = 12)))
(c2 <- fviz_contrib(pc_pie, choice = "var", axes = c(1,2), sort.val = "desc") + ylab("Contribution %") + labs(title = "Contribution of variables to PC2") +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size = 12)))
# PCA tentacular ----
datos_pca_t <- datos_long2 %>%  filter(cultivo == "Si", tejido == "Tentaculo") %>%
select(c(6:18), -proteina, -G6PDH)
colnames(datos_pca_t) <- c("SOD", "CAT", "GPx", "GR", "GST", "DTD", "TEAC", "MDA", "Acid.phospatase", "Alkaline.phosphatase", "MPx")
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_t)
pc_tent <- princomp(~., data = as.data.frame(datos_pca_t), cor = TRUE)
summary(pc_tent)
(biplot_t <- fviz_pca_biplot(pc_tent, axes = c(1,2), col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(c3 <- fviz_contrib(pc_tent, choice = "var", axes = 1, sort.val = "desc") + ylab("Contribution %") + labs(title = "Contribution of variables to PC1") +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size = 12)))
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_t)
# Figuras ----
c1 + c2 + c3
# Figuras ----
c1 | c2 | c3
# Figuras ----
c1 / c2 / c3
# PCA columnar ----
datos_pca_p <- datos_2 %>% filter(tejido == "Pie") %>%
select(c(6:18), -proteina, -G6PDH)
colnames(datos_pca_p) <- c("SOD", "CAT", "GPx", "GR", "GST", "DTD", "TEAC", "MDA", "AP", "ALP", "MPx")
pc_pie <- princomp(~., data = as.data.frame(datos_pca_p), cor = TRUE)
summary(pc_pie)
(biplot_p <- fviz_pca_biplot(pc_pie, col.ind = na.omit(select(filter(datos_2, tejido == "Pie"), -Lisozima, -G6PDH))$section:na.omit(select(filter(datos_2, tejido == "Pie"), -Lisozima, -G6PDH))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(c1 <- fviz_contrib(pc_pie, choice = "var", axes = 1, sort.val = "desc") + ylab("Contribution %") + labs(title = "Contribution of variables to PC1") +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size = 12)))
(c2 <- fviz_contrib(pc_pie, choice = "var", axes = 2, sort.val = "desc") + ylab("Contribution %") + labs(title = "Contribution of variables to PC2") +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size = 12)))
# PCA tentacular ----
datos_pca_t <- datos_long2 %>%  filter(cultivo == "Si", tejido == "Tentaculo") %>%
select(c(6:18), -proteina, -G6PDH)
colnames(datos_pca_t) <- c("SOD", "CAT", "GPx", "GR", "GST", "DTD", "TEAC", "MDA", "AP", "ALP", "MPx")
pc_tent <- princomp(~., data = as.data.frame(datos_pca_t), cor = TRUE)
summary(pc_tent)
(biplot_t <- fviz_pca_biplot(pc_tent, axes = c(1,2), col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
#ylab("PC2 (27.6%)") + xlab("PC1 (57.3%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(c3 <- fviz_contrib(pc_tent, choice = "var", axes = 1, sort.val = "desc") + ylab("Contribution %") + labs(title = "Contribution of variables to PC1") +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size = 12)))
# Figuras ----
c1 / c2 / c3
(c1 <- fviz_contrib(pc_pie, choice = "var", axes = 1, sort.val = "desc") + ylab("Contribution %") + labs(title = "Contribution of columnar variables to PC1") +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size = 12)))
(c2 <- fviz_contrib(pc_pie, choice = "var", axes = 2, sort.val = "desc") + ylab("Contribution %") + labs(title = "Contribution of columnar variables to PC2") +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size = 12)))
(c3 <- fviz_contrib(pc_tent, choice = "var", axes = 1, sort.val = "desc") + ylab("Contribution %") + labs(title = "Contribution of tentacular variables to PC1") +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size = 12)))
# Figuras ----
c1 / c2 / c3
free(biplot_p/biplot_t) + (c1 / c2 / c3)
(free(biplot_p)/free(biplot_t)) + (c1 / c2 / c3)
(free(biplot_p)/free(biplot_t)) + (c1 / c2 / c3)
(free(biplot_p)/free(biplot_t)) + (c1 / c2 / c3)
(free(biplot_p)/free(biplot_t)) + (c1 / c2 / c3)
free(biplot_p/biplot_t) + (c1 / c2 / c3)
free(biplot_p/biplot_t) + (c1 / c2 / c3) +plot_layout(widths = c(2, 1))
free(biplot_p/biplot_t) + (c1 / c2 / c3) + plot_annotation(tag_levels = 'a')
free(biplot_p/biplot_t) + (c1 / c2 / c3) + plot_annotation(tag_levels = 'A')
free(biplot_p/biplot_t) + (c1 / c2 / c3) + plot_annotation(tag_levels = 'A') + plot_layout(guides = "collect")
free(biplot_p/biplot_t) + (c1 / c2 / c3) + plot_annotation(tag_levels = 'A') + plot_layout(guides = "collect")
ggarrange(biplot_p, biplot_t, ncol = 1, nrow = 2, common.legend = T, legend = "bottom") + (c1 / c2 / c3) + plot_annotation(tag_levels = 'A')
warnings()
biplot_p+biplot_t / (c1+c2+c3)
(biplot_p+biplot_t) / (c1+c2+c3)
((biplot_p+biplot_t) / (c1+c2+c3)) + plot_layout(widths = c(1, 2)))
((biplot_p+biplot_t) / (c1+c2+c3)) + plot_layout(widths = c(1, 2))
((biplot_p+biplot_t) / (c1+c2+c3)) + plot_layout(widths = c(1, 3))
((biplot_p+biplot_t) / (c1+c2+c3)) + plot_layout(widths = c(2, 3))
?plot_layout
((biplot_p+biplot_t) / (c1+c2+c3)) + plot_layout(heights = c(2, 1))
((biplot_p+biplot_t) / (c1+c2+c3)) + plot_layout(heights = c(3, 1))
((biplot_p+biplot_t) / (c1+c2+c3)) + plot_layout(heights = c(3, 2))
((biplot_p+biplot_t) / (c1+c2+c3)) + plot_layout(heights = c(3, 1))
((biplot_p+biplot_t) / (c1+c2+c3)) + plot_layout(heights = c(3, 1)) + + plot_annotation(tag_levels = 'A')
((biplot_p+biplot_t) / (c1+c2+c3)) + plot_layout(heights = c(3, 1))+ plot_annotation(tag_levels = 'A')
((biplot_p+biplot_t) / (c1+c2+c3)) + plot_layout(heights = c(3, 1), guides = "collect")+ plot_annotation(tag_levels = 'A')
((biplot_p+biplot_t) / (c1+c2+c3)) + plot_layout(heights = c(3, 1), guides = "collect")+ plot_annotation(tag_levels = 'A')
p <- ((biplot_p+biplot_t) / (c1+c2+c3)) + plot_annotation(tag_levels = 'A') + plot_layout(heights = c(3, 1), guides = "collect") & theme(legend.position = "bottom")
p <- ((biplot_p+biplot_t) / (c1+c2+c3)) + plot_annotation(tag_levels = 'A') + plot_layout(heights = c(3, 1))
(p <- ((biplot_p+biplot_t) / (c1+c2+c3)) + plot_annotation(tag_levels = 'A') + plot_layout(heights = c(3, 1), guides = "collect") & theme(legend.position = "bottom"))
(p <- ((biplot_p+biplot_t+plot_layout(guides = "collect")) / (c1+c2+c3)) + plot_annotation(tag_levels = 'A') + plot_layout(heights = c(3, 1)) & theme(legend.position = "bottom"))
ggsave(filename = "./resultados/pca.svg", width = 300, height = 200, units = "mm", dpi = 1000)
ggsave(p, filename = "./resultados/pca.png", width = 300, height = 200, units = "mm", dpi = 1000)
ggsave(p, filename = "./resultados/pca.svg", width = 300, height = 250, units = "mm", dpi = 1000)
ggsave(p, filename = "./resultados/pca.png", width = 300, height = 250, units = "mm", dpi = 1000)
(c1 <- fviz_contrib(pc_pie, choice = "var", axes = 1, sort.val = "desc") + ylab("Contribution %") + labs(title = "Column - Contribution to PC1") +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size = 12)))
(c2 <- fviz_contrib(pc_pie, choice = "var", axes = 2, sort.val = "desc") + ylab("Contribution %") + labs(title = "Column - Contribution to PC2") +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size = 12)))
(c3 <- fviz_contrib(pc_tent, choice = "var", axes = 1, sort.val = "desc") + ylab("Contribution %") + labs(title = "Tentacle - Contribution to PC1") +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size = 12)))
# Figuras ----
(p <- ((biplot_p+biplot_t+plot_layout(guides = "collect")) / (c1+c2+c3)) + plot_annotation(tag_levels = 'A') + plot_layout(heights = c(3, 1)) & theme(legend.position = "bottom"))
ggsave(p, filename = "./resultados/pca.svg", width = 300, height = 250, units = "mm", dpi = 1000)
ggsave(p, filename = "./resultados/pca.png", width = 300, height = 250, units = "mm", dpi = 1000)
?fviz_pca_biplot()
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_t)
(biplot_t <- fviz_pca_biplot(pc_tent, axes = c(1,2), col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
ylab("PC2 (15.8%)") + xlab("PC1 (35%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(biplot_t <- fviz_pca_biplot(pc_tent, axes = c(1,2), col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
ylab("PC2 (15.8%)") + xlab("PC1 (35%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(biplot_t <- fviz_pca_biplot(pc_tent, axes = c(1,2), col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
ylab("PC2 (15.8%)") + xlab("PC1 (35%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
biplot_t <- fviz_pca_biplot(pc_tent, axes = c(1,2), col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
ylab("PC2 (15.8%)") + xlab("PC1 (35%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank())
# Test de permutacion de Vieira
pca_per <- PCAtest(datos_pca_p)
?PCAtest()
(biplot_p <- fviz_pca_biplot(pc_pie, col.ind = na.omit(select(filter(datos_2, tejido == "Pie"), -Lisozima, -G6PDH))$section:na.omit(select(filter(datos_2, tejido == "Pie"), -Lisozima, -G6PDH))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
ylab("PC2 (18.8%)") + xlab("PC1 (33.1%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
(biplot_t <- fviz_pca_biplot(pc_tent, axes = c(1,2), col.ind = na.omit(select(filter(datos_long2, cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$section:na.omit(select(filter(datos_long2,cultivo == "Si", tejido == "Tentaculo"), -Lisozima, -G6PDH))$time,
pointshape = 16, pointsize = 2.5,
addEllipses = TRUE, ellipse.type = "confidence",
label = "var", col.var = "grey20", repel = T,
invisible="quali") +
scale_color_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
scale_fill_manual(labels = c("Control T1", "Control T2", "Section T1", "Section T2"), values = c("#92C5DE", "#0571B0", "#F4A582", "#D6604D")) +
ylab("PC2 (15.8%)") + xlab("PC1 (35%)") +
theme_pubr() +
labs_pubr() +
theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 40/.pt),
plot.title = element_blank()))
# Figuras ----
(p <- ((biplot_p+biplot_t+plot_layout(guides = "collect")) / (c1+c2+c3)) + plot_annotation(tag_levels = 'A') + plot_layout(heights = c(3, 1)) & theme(legend.position = "bottom"))
ggsave(p, filename = "./resultados/pca.svg", width = 300, height = 250, units = "mm", dpi = 1000)
ggsave(p, filename = "./resultados/pca.png", width = 300, height = 250, units = "mm", dpi = 1000)
ggsave(p, filename = "./resultados/graficas2025/pca.svg", width = 300, height = 250, units = "mm", dpi = 1000)
ggsave(p, filename = "./resultados/graficas2025/pca.png", width = 300, height = 250, units = "mm", dpi = 1000)
ggsave(p, filename = "./resultados/graficas2025/pca.svg", width = 250, height = 200, units = "mm", dpi = 1000)
ggsave(p, filename = "./resultados/graficas2025/pca.png", width = 250, height = 200, units = "mm", dpi = 1000)
