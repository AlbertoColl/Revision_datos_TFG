labels = c("Calahonda control", "Calahonda dissected", "Almuñécar control", "Almuñécar dissected", "Salobreña control", "Salobreña dissected")) +
scale_shape_manual(name = "Sampling point\n and Treatment",
values = c(16, 17, 16, 17, 16, 17),
labels = c("Calahonda control", "Calahonda dissected", "Almuñécar control", "Almuñécar dissected", "Salobreña control", "Salobreña dissected")) +
guides(linetype = "none") +
scale_x_discrete(labels = c("First", "Second")) +
theme_ortimar() +
theme(legend.position = "bottom", legend.direction = "horizontal",
legend.title = element_text(size=10), #change legend title font size
legend.text = element_text(size=8)) #change legend text font size)
ggplot(data = tabla_summ, aes(x = tiempo, y = media, color = playa:corte, shape = playa:corte)) +
geom_errorbar(aes(ymax = media + error, ymin = media - error, group = corte), width = .15, position = position_dodge(width = .25)) +
geom_point(size = 4.5, alpha = .8, position = position_dodge(width = .25)) +
geom_line(aes(group = corte, linetype = corte), linewidth = 1.5, position = position_dodge(width = .25)) +
# geom_text(aes(label = Letters, y = media, group = playa),              position = position_jitter(width = 0.05), color = "gray5",              check_overlap = TRUE, hjust = -0.5, vjust = -0.5) +
facet_wrap(~playa) +
labs(title = paste(case_when(
i == "proteina_t" | i == "proteina_p"  ~ "Protein content",
i == "MDA_t" | i == "MDA_p" ~ "MDA concentration",
i == "TEAC_t" | i == "TEAC_p"~ "Trolox equivalent antioxidant capacity (TEAC)",
TRUE ~ paste(str_split(i, "_")[[1]][1], "activity")), case_when(
str_detect(i, "_p") == TRUE ~ "on pedal disk\n",
TRUE ~ "on tentacle\n"))) +
#caption = "\na,b,c: differences across sampling points    *: differences between treatments    +: differences between samplings") +
ylab(case_when(
i == "proteina_t" | i == "proteina_p"  ~ "protein mg / ml",
i == "MDA_t" | i == "MDA_p" ~ "MDA μM ",
i == "TEAC_t" | i == "TEAC_p"~ "Trolox equivalent μM",
i == "GR_t" | i == "GR_p" ~ "mU / mg  of protein",
i == "GST_t" | i == "GST_p" ~ "mU / mg  of protein",
i == "DTD_t" | i == "DTD_p" ~ "mU / mg  of protein",
TRUE ~ "U / mg  of protein")) +
xlab("Sampling") +
scale_color_manual(name = "Sampling point\n and treatment",
values = c("#414066", "#414066", "#69B4AB", "#69B4AB", "#FBBC4C", "#FBBC4C"),
labels = c("Calahonda control", "Calahonda dissected", "Almuñécar control", "Almuñécar dissected", "Salobreña control", "Salobreña dissected")) +
scale_shape_manual(name = "Sampling point\n and Treatment",
values = c(16, 17, 16, 17, 16, 17),
labels = c("Calahonda control", "Calahonda dissected", "Almuñécar control", "Almuñécar dissected", "Salobreña control", "Salobreña dissected")) +
guides(linetype = "none") +
scale_x_discrete(labels = c("First", "Second")) +
theme_ortimar() +
theme(legend.position = "bottom", legend.direction = "horizontal")
ggplot(data = tabla_summ, aes(x = tiempo, y = media, color = playa:corte, shape = playa:corte)) +
geom_errorbar(aes(ymax = media + error, ymin = media - error, group = corte), width = .15, position = position_dodge(width = .25)) +
geom_point(size = 4.5, alpha = .8, position = position_dodge(width = .25)) +
geom_line(aes(group = corte, linetype = corte), linewidth = 1.5, position = position_dodge(width = .25)) +
# geom_text(aes(label = Letters, y = media, group = playa),              position = position_jitter(width = 0.05), color = "gray5",              check_overlap = TRUE, hjust = -0.5, vjust = -0.5) +
facet_wrap(~playa) +
labs(title = paste(case_when(
i == "proteina_t" | i == "proteina_p"  ~ "Protein content",
i == "MDA_t" | i == "MDA_p" ~ "MDA concentration",
i == "TEAC_t" | i == "TEAC_p"~ "Trolox equivalent antioxidant capacity (TEAC)",
TRUE ~ paste(str_split(i, "_")[[1]][1], "activity")), case_when(
str_detect(i, "_p") == TRUE ~ "on pedal disk\n",
TRUE ~ "on tentacle\n"))) +
#caption = "\na,b,c: differences across sampling points    *: differences between treatments    +: differences between samplings") +
ylab(case_when(
i == "proteina_t" | i == "proteina_p"  ~ "protein mg / ml",
i == "MDA_t" | i == "MDA_p" ~ "MDA μM ",
i == "TEAC_t" | i == "TEAC_p"~ "Trolox equivalent μM",
i == "GR_t" | i == "GR_p" ~ "mU / mg  of protein",
i == "GST_t" | i == "GST_p" ~ "mU / mg  of protein",
i == "DTD_t" | i == "DTD_p" ~ "mU / mg  of protein",
TRUE ~ "U / mg  of protein")) +
xlab("Sampling") +
scale_color_manual(name = "Sampling point\n and treatment",
values = c("#414066", "#414066", "#69B4AB", "#69B4AB", "#FBBC4C", "#FBBC4C"),
labels = c("Calahonda control", "Calahonda dissected", "Almuñécar control", "Almuñécar dissected", "Salobreña control", "Salobreña dissected")) +
scale_shape_manual(name = "Sampling point\n and treatment",
values = c(16, 17, 16, 17, 16, 17),
labels = c("Calahonda control", "Calahonda dissected", "Almuñécar control", "Almuñécar dissected", "Salobreña control", "Salobreña dissected")) +
guides(linetype = "none") +
scale_x_discrete(labels = c("First", "Second")) +
theme_ortimar() +
theme(legend.position = "bottom", legend.direction = "horizontal")
ggplot(data = tabla_summ, aes(x = tiempo, y = media, color = playa:corte, shape = playa:corte)) +
geom_errorbar(aes(ymax = media + error, ymin = media - error, group = corte), width = .15, position = position_dodge(width = .25)) +
geom_point(size = 4.5, alpha = .8, position = position_dodge(width = .25)) +
geom_line(aes(group = corte, linetype = corte), linewidth = 1.5, position = position_dodge(width = .25)) +
# geom_text(aes(label = Letters, y = media, group = playa),              position = position_jitter(width = 0.05), color = "gray5",              check_overlap = TRUE, hjust = -0.5, vjust = -0.5) +
facet_wrap(~playa) +
labs(title = paste(case_when(
i == "proteina_t" | i == "proteina_p"  ~ "Protein content",
i == "MDA_t" | i == "MDA_p" ~ "MDA concentration",
i == "TEAC_t" | i == "TEAC_p"~ "Trolox equivalent antioxidant capacity (TEAC)",
TRUE ~ paste(str_split(i, "_")[[1]][1], "activity")), case_when(
str_detect(i, "_p") == TRUE ~ "on pedal disk\n",
TRUE ~ "on tentacle\n"))) +
#caption = "\na,b,c: differences across sampling points    *: differences between treatments    +: differences between samplings") +
ylab(case_when(
i == "proteina_t" | i == "proteina_p"  ~ "protein mg / ml",
i == "MDA_t" | i == "MDA_p" ~ "MDA μM ",
i == "TEAC_t" | i == "TEAC_p"~ "Trolox equivalent μM",
i == "GR_t" | i == "GR_p" ~ "mU / mg  of protein",
i == "GST_t" | i == "GST_p" ~ "mU / mg  of protein",
i == "DTD_t" | i == "DTD_p" ~ "mU / mg  of protein",
TRUE ~ "U / mg  of protein")) +
xlab("Sampling") +
scale_color_manual(name = "Sampling point\n and treatment",
values = c("#414066", "#414066", "#69B4AB", "#69B4AB", "#FBBC4C", "#FBBC4C"),
labels = c("Calahonda control", "Calahonda dissected", "Almuñécar control", "Almuñécar dissected", "Salobreña control", "Salobreña dissected")) +
scale_shape_manual(name = "Sampling point\n and treatment",
values = c(16, 17, 16, 17, 16, 17),
labels = c("Calahonda control", "Calahonda dissected", "Almuñécar control", "Almuñécar dissected", "Salobreña control", "Salobreña dissected")) +
guides(linetype = "none") +
scale_x_discrete(labels = c("First", "Second")) +
theme_ortimar() +
theme(legend.position = "bottom", legend.direction = "horizontal")
knitr::opts_knit$set(root.dir = "D:/collf/Documents/GitHub/TFG-Alberto-Coll")
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
library(tidyverse)
library(ggthemr)
library(multcompView)
source(file = "./scripts/0_data_home.R")
source(file = "./scripts/1_funciones_graficas.R")
# SOD TENTACULO
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
n <- 1
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(datos[6:25])[[n]]
tabla_summ <- datos %>% group_by(playa, corte, tiempo) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i))))) %>%
arrange(desc(media))
tabla_summ$Letters <- rep("", 12)
plot <- barras()
print(plot)
# SOD TENTACULO
n <- 1
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(datos[6:25])[[n]]
tabla_summ <- datos %>% group_by(playa, corte, tiempo) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i))))) %>%
arrange(desc(media))
tabla_summ$Letters <- rep("", 12)
plot <- interact()
print(plot)
knitr::kable(head(datos))
?head
knitr::kable(head(datos, n = c(1:10))
knitr::kable(head(datos, n = c(1:10)))
knitr::kable(head(datos, n = 10))
head(datos)
head(datos, n = 8)
View(datos)
knitr::kable(head(filter(datos, individuo, playa, corte, tiempo, SOD_t, CAT_t, GPx_t)))
filter(datos, individuo, playa, corte, tiempo, SOD_t, CAT_t, GPx_t)
filter()
?filter()
knitr::kable(head(select(datos, individuo, playa, corte, tiempo, SOD_t, CAT_t, GPx_t)))
knitr::kable(head(select(datos, individuo, playa, corte, tiempo, SOD_t, CAT_t, GPx_t, GR_t)))
# GST TENTACULO
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
n <- 5
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(datos[6:25])[[n]]
tabla_summ <- datos %>% group_by(playa, corte, tiempo) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i))))) %>%
arrange(desc(media))
tabla_summ$Letters <- rep("", 12)
plot <- interact()
print(plot)
### SETUP ----
library(tidyverse)
library(ggthemr)
library(multcompView)
library(car)
# Directorio en laboratorio: C:/Users/Usuario/Documents/TFG Alberto Coll
# Directorio en portatil: D:/collf/Documents/GitHub/TFG-Alberto-Coll
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
# Llamamos el script de lectura
#source(file = "./scripts/0_data_lab.R") # Laboratorio
source(file = "./scripts/0_data_home.R") # En casa
datos <- datos %>% filter(cultivo == "Si")
source(file = "./scripts/1_funciones_graficas.R") # Para tener las funciones de las graficas
### Ajuste de modelo EXTENDIDO ----
# Creamos una lista de formulas con sapply(), y posteriormente aplicamos a dicha lista el lm()
formulas <- sapply(colnames(datos[c(6:25)]), function(x){as.formula(paste0(x, " ~ playa * corte * tiempo"))}) # En el analisis extendido vamos a ver la interaccion entre corte y tiempo, ademas de incluir el factor playa
# Creamos modelos con esas formulas
modelos <- sapply(formulas, function(x){aov(x, datos)})
# Ahora comprobamos los modelos a ver que tal y en cuales quitamos interaccion (o playa)
sapply(modelos, function(x){summary(x)})
# En el siguiente bloque voy a ajustar un modelo mas parsimonioso, sin la interaccion, para eliminar el termino en aquellos casos donde no haya diferencia significativa entre ambos modelos
formulas_sin <- sapply(colnames(datos[c(6:25)]), function(x){as.formula(paste0(x, " ~ playa * corte + tiempo"))})
n <- 0
for (variable in colnames(datos[c(6:25)])) {
n <- n + 1
modelo_sin <- aov(formulas_sin[[n]], datos)
print("Se ha ajustado el modelo sin interaccion")
likelihood <- anova(modelos[[n]], modelo_sin)
print("Se ha hecho el ANOVA")
if (n != 3) {
if (likelihood$`Pr(>F)`[2] > 0.05) {
print("No hay diferencias, sustituimos")
modelos[[n]] <- modelo_sin
}  else {print("Los modelos son diferentes, nos quedamos con el complejo")
}
}
}
# Hay que hacerlo ahora con playa, para cada uno utilizando playa+corte+tiempo o playa+corte*tiempo segun se haya eliminado la interaccion o no
formulas_sin <- sapply(colnames(datos[c(6:25)]), function(x){as.formula(paste0(x, " ~ playa + corte + tiempo"))})
n <- 0
for (variable in colnames(datos[c(6:25)])) {
n <- n + 1
modelo_sin <- aov(formulas_sin[[n]], datos)
print("Se ha ajustado el modelo sin interaccion")
likelihood <- anova(modelos[[n]], modelo_sin)
print("Se ha hecho el ANOVA")
if (n != 3) {
if (likelihood$`Pr(>F)`[2] > 0.05) {
print("No hay diferencias, sustituimos")
modelos[[n]] <- modelo_sin
}  else {print("Los modelos son diferentes, nos quedamos con el complejo")}
}}
summary(modelos[[5]])
summary(modelos[[5]])
# GST PIE
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
n <- 15
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(datos[6:25])[[n]]
tabla_summ <- datos %>% group_by(playa, corte, tiempo) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i))))) %>%
arrange(desc(media))
tabla_summ$Letters <- rep("", 12)
plot <- interact()
print(plot)
summary(modelos[[15]])
# DTD TENTACULO
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
n <- 6
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(datos[6:25])[[n]]
tabla_summ <- datos %>% group_by(playa, corte, tiempo) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i))))) %>%
arrange(desc(media))
tabla_summ$Letters <- rep("", 12)
plot <- interact()
print(plot)
summary(modelos[[6]])
# DTD PIE
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
n <- 16
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(datos[6:25])[[n]]
tabla_summ <- datos %>% group_by(playa, corte, tiempo) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i))))) %>%
arrange(desc(media))
tabla_summ$Letters <- rep("", 12)
plot <- interact()
print(plot)
summary(modelos[[16]])
# G6PDH TENTACULO
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
n <- 7
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(datos[6:25])[[n]]
tabla_summ <- datos %>% group_by(playa, corte, tiempo) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i))))) %>%
arrange(desc(media))
tabla_summ$Letters <- rep("", 12)
plot <- interact()
print(plot)
SUMMARY(modelos[[7]])
summary(modelos[[7]])
# G6PDH PIE
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
n <- 17
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(datos[6:25])[[n]]
tabla_summ <- datos %>% group_by(playa, corte, tiempo) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i))))) %>%
arrange(desc(media))
tabla_summ$Letters <- rep("", 12)
plot <- interact()
print(plot)
summary(modelos[[17]])
# TEAC PIE
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
n <- 8
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(datos[6:25])[[n]]
tabla_summ <- datos %>% group_by(playa, corte, tiempo) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i))))) %>%
arrange(desc(media))
tabla_summ$Letters <- rep("", 12)
plot <- interact()
print(plot)
summary(modelos[[8]])
# TEAC PIE
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
n <- 18
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(datos[6:25])[[n]]
tabla_summ <- datos %>% group_by(playa, corte, tiempo) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i))))) %>%
arrange(desc(media))
tabla_summ$Letters <- rep("", 12)
plot <- interact()
print(plot)
summary(modelos[[18]])
# MDA TENTACULO
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
n <- 9
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(datos[6:25])[[n]]
tabla_summ <- datos %>% group_by(playa, corte, tiempo) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i))))) %>%
arrange(desc(media))
tabla_summ$Letters <- rep("", 12)
plot <- interact()
print(plot)
summary(modelos[[9]])
# MDA PIE
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
n <- 19
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(datos[6:25])[[n]]
tabla_summ <- datos %>% group_by(playa, corte, tiempo) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i))))) %>%
arrange(desc(media))
tabla_summ$Letters <- rep("", 12)
plot <- interact()
print(plot)
summary(modelos[[19]])
# proteina TENTACULO
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
n <- 10
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(datos[6:25])[[n]]
tabla_summ <- datos %>% group_by(playa, corte, tiempo) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i))))) %>%
arrange(desc(media))
tabla_summ$Letters <- rep("", 12)
plot <- interact()
print(plot)
summary(modelos[[10]])
# proteina PIE
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
n <- 20
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(datos[6:25])[[n]]
tabla_summ <- datos %>% group_by(playa, corte, tiempo) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i))))) %>%
arrange(desc(media))
tabla_summ$Letters <- rep("", 12)
plot <- interact()
print(plot)
summary(modelos[[20]])
# proteina PIE
setwd("D:/collf/Documents/GitHub/TFG-Alberto-Coll")
n <- 20
# Crear tabla_summ y llamar a barras() o interact()
i <- colnames(datos[6:25])[[n]]
tabla_summ <- datos %>% group_by(playa, corte, tiempo) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i))))) %>%
arrange(desc(media))
tabla_summ$Letters <- rep("", 12)
plot <- interact()
print(plot)
ggplot(data = tabla_summ, aes(x = tiempo, y = media, color = playa:corte, shape = playa:corte)) +
geom_errorbar(aes(ymax = media + error, ymin = media - error, group = corte), width = .15, position = position_dodge(width = .25)) +
geom_point(size = 4.5, alpha = .8, position = position_dodge(width = .25)) +
geom_line(aes(group = corte, linetype = corte), linewidth = 1.5, position = position_dodge(width = .25)) +
# geom_text(aes(label = Letters, y = media, group = playa),              position = position_jitter(width = 0.05), color = "gray5",              check_overlap = TRUE, hjust = -0.5, vjust = -0.5) +
facet_wrap(~playa) +
labs(title = paste(case_when(
i == "proteina_t" | i == "proteina_p"  ~ "Protein content",
i == "MDA_t" | i == "MDA_p" ~ "MDA concentration",
i == "TEAC_t" | i == "TEAC_p"~ "Trolox equivalent antioxidant capacity (TEAC)",
TRUE ~ paste(str_split(i, "_")[[1]][1], "activity")), case_when(
str_detect(i, "_p") == TRUE ~ "on pedal disk\n",
TRUE ~ "on tentacle\n"))) +
#caption = "\na,b,c: differences across sampling points    *: differences between treatments    +: differences between samplings") +
ylab(case_when(
i == "proteina_t" | i == "proteina_p"  ~ "protein mg / ml",
i == "MDA_t" | i == "MDA_p" ~ "MDA μM ",
i == "TEAC_t" | i == "TEAC_p"~ "Trolox equivalent μM",
i == "GR_t" | i == "GR_p" ~ "mU / mg  of protein",
i == "GST_t" | i == "GST_p" ~ "mU / mg  of protein",
i == "DTD_t" | i == "DTD_p" ~ "mU / mg  of protein",
TRUE ~ "U / mg  of protein")) +
xlab("Sampling") +
scale_color_manual(name = "Sampling point\n and treatment",
values = c("#414066", "#414066", "#69B4AB", "#69B4AB", "#FBBC4C", "#FBBC4C"),
labels = c("Calahonda control", "Calahonda dissected", "Almuñécar control", "Almuñécar dissected", "Salobreña control", "Salobreña dissected")) +
scale_shape_manual(name = "Sampling point\n and treatment",
values = c(16, 17, 16, 17, 16, 17),
labels = c("Calahonda control", "Calahonda dissected", "Almuñécar control", "Almuñécar dissected", "Salobreña control", "Salobreña dissected")) +
guides(linetype = "none") +
scale_x_discrete(labels = c("First", "Second")) +
theme_ortimar() +
theme(legend.position = "bottom", legend.direction = "horizontal",
legend.text = element_text(size = 9),
legend.title = element_text(size = 11))
ggplot(data = tabla_summ, aes(x = tiempo, y = media, color = playa:corte, shape = playa:corte)) +
geom_errorbar(aes(ymax = media + error, ymin = media - error, group = corte), width = .15, position = position_dodge(width = .25)) +
geom_point(size = 4.5, alpha = .8, position = position_dodge(width = .25)) +
geom_line(aes(group = corte, linetype = corte), linewidth = 1.5, position = position_dodge(width = .25)) +
# geom_text(aes(label = Letters, y = media, group = playa),              position = position_jitter(width = 0.05), color = "gray5",              check_overlap = TRUE, hjust = -0.5, vjust = -0.5) +
facet_wrap(~playa) +
#labs(title = paste(case_when(
#      i == "proteina_t" | i == "proteina_p"  ~ "Protein content",
#      i == "MDA_t" | i == "MDA_p" ~ "MDA concentration",
#      i == "TEAC_t" | i == "TEAC_p"~ "Trolox equivalent antioxidant capacity (TEAC)",
#      TRUE ~ paste(str_split(i, "_")[[1]][1], "activity")), case_when(
#        str_detect(i, "_p") == TRUE ~ "on pedal disk\n",
#        TRUE ~ "on tentacle\n"))) +
#caption = "\na,b,c: differences across sampling points    *: differences between treatments    +: differences between samplings") +
ylab(case_when(
i == "proteina_t" | i == "proteina_p"  ~ "protein mg / ml",
i == "MDA_t" | i == "MDA_p" ~ "MDA μM ",
i == "TEAC_t" | i == "TEAC_p"~ "Trolox equivalent μM",
i == "GR_t" | i == "GR_p" ~ "mU / mg  of protein",
i == "GST_t" | i == "GST_p" ~ "mU / mg  of protein",
i == "DTD_t" | i == "DTD_p" ~ "mU / mg  of protein",
TRUE ~ "U / mg  of protein")) +
xlab("Sampling") +
scale_color_manual(name = "Sampling point\n and treatment",
values = c("#414066", "#414066", "#69B4AB", "#69B4AB", "#FBBC4C", "#FBBC4C"),
labels = c("Calahonda control", "Calahonda dissected", "Almuñécar control", "Almuñécar dissected", "Salobreña control", "Salobreña dissected")) +
scale_shape_manual(name = "Sampling point\n and treatment",
values = c(16, 17, 16, 17, 16, 17),
labels = c("Calahonda control", "Calahonda dissected", "Almuñécar control", "Almuñécar dissected", "Salobreña control", "Salobreña dissected")) +
guides(linetype = "none") +
scale_x_discrete(labels = c("First", "Second")) +
theme_ortimar() +
theme(legend.position = "bottom", legend.direction = "horizontal",
legend.text = element_text(size = 9),
legend.title = element_text(size = 11))
modelos <- sapply(formulas, function(x){lm(x, datos)})
formulas_sin <- sapply(colnames(datos[c(6:25)]), function(x){as.formula(paste0(x, " ~ playa * corte + tiempo"))})
n <- 0
<- 0
for (variable in colnames(datos[c(6:25)])) {
n <- n + 1
modelo_sin <- lm(formulas_sin[[n]], datos)
print("Se ha ajustado el modelo sin interaccion")
likelihood <- anova(modelos[[n]], modelo_sin)
print("Se ha hecho el ANOVA")
if (n != 3) {
if (likelihood$`Pr(>F)`[2] > 0.05) {
print("No hay diferencias, sustituimos")
modelos[[n]] <- modelo_sin
}  else {print("Los modelos son diferentes, nos quedamos con el complejo")
}
}
}
formulas_sin <- sapply(colnames(datos[c(6:25)]), function(x){as.formula(paste0(x, " ~ playa + corte + tiempo"))})
n <- 0
for (variable in colnames(datos[c(6:25)])) {
n <- n + 1
modelo_sin <- lm(formulas_sin[[n]], datos)
print("Se ha ajustado el modelo sin interaccion")
likelihood <- anova(modelos[[n]], modelo_sin)
print("Se ha hecho el ANOVA")
if (n != 3) {
if (likelihood$`Pr(>F)`[2] > 0.05) {
print("No hay diferencias, sustituimos")
modelos[[n]] <- modelo_sin
}  else {print("Los modelos son diferentes, nos quedamos con el complejo")}
}}
# GR_t no sigue normalidad de residuos, con transformación log se resuelve
modelos[[4]] <- lm(log(GR_t) ~ playa + corte + tiempo, datos)
summary(modelos[[1]])
summary(modelos[[11]])
summary(modelos[[2]])
summary(modelos[[12]])
summary(modelos[[4]])
summary(modelos[[14]])
summary(modelos[[5]])
summary(modelos[[15]])
summary(modelos[[6]])
summary(modelos[[16]])
summary(modelos[[7]])
summary(modelos[[17]])
summary(modelos[[8]])
summary(modelos[[18]])
summary(modelos[[9]])
summary(modelos[[19]])
summary(modelos[[10]])
summary(modelos[[20]])
